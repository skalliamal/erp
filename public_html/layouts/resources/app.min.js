'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

var AppConnector,App={},app={languageString:[],breakpoints:{xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1300,xxxl:1700},cacheParams:[],modalEvents:[],childFrame:!1,event:new function(){this.el=$({}),this.trigger=function(){this.el.trigger(arguments[0],Array.prototype.slice.call(arguments,1));},this.on=function(){this.el.on.apply(this.el,arguments);},this.one=function(){this.el.one.apply(this.el,arguments);},this.off=function(){this.el.off.apply(this.el,arguments);};},getModuleName:function a(){return this.getMainParams('module')},getParentModuleName:function a(){return this.getMainParams('parent')},getViewName:function a(){return this.getMainParams('view')},getRecordId:function c(){var a,b=this.getViewName();return 'Edit'==b||'PreferenceEdit'?a=this.getMainParams('recordId'):('Detail'==b||'PreferenceDetail')&&(a=this.getMainParams('recordId')),a},getLanguage:function a(){return $('body').data('language')},getPageTitle:function a(){return document.title},getWindowParent:function a(){return 'undefined'!=typeof window.frames[0]&&'undefined'!=typeof window.frames[0].app&&window.frames[0].app.childFrame?window.frames[0]:window},setPageTitle:function b(a){document.title=a;},getContentsContainer:function a(){return $('.bodyContents')},hidePopover:function b(a){'undefined'==typeof a&&(a=$('body .js-popover-tooltip')),a.popover('hide');},hidePopoversAfterClick:function b(a){a.on('click',function(){setTimeout(function(){a.popover('hide');},100);});},registerPopoverManualTrigger:function b(a){a.hoverIntent({timeout:150,over:function b(){var a=this;$(this).popover('show'),$('.popover').on('mouseleave',function(){$(a).popover('hide');});},out:function a(){$('.popover:hover').length||$(this).popover('hide');}}),app.hidePopoversAfterClick(a);},isEllipsisActive:function c(a){var b=a.clone().addClass('u-text-ellipsis--not-active').appendTo('body');return b.width()>a.width()?(b.remove(),!0):(b.remove(),!1)},showPopoverElementView:function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c={trigger:'manual',placement:'auto',html:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',container:'body',delay:{show:300,hide:100}};return a.each(function(a,d){var e=$(d);if(!(e.data('ellipsis')&&(c.trigger='hover focus',!app.isEllipsisActive(e)))){var f=$.extend(!0,c,b,e.data());e.data('class')&&(f.template='<div class="popover '+e.data('class')+'" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'),e.hasClass('delay0')&&(f.delay={show:0,hide:0}),e.popover(f),('manual'===f.trigger||'undefined'==typeof f.trigger)&&app.registerPopoverManualTrigger(e);}}),a},registerChangeEventForMultiSelect:function e(a,b){if('undefined'!=typeof a){var c=a.data('select2'),d=b.maximumSelectionLength;a.on('change',function(){var a=c.data();$.isArray(a)&&a.length>=d&&c.updateResults();});}},getSerializedData:function k(a,b){'undefined'==typeof b&&(b='string'),a=$(a);var c=a.children().serialize();if('string'==b)return c;var d={},e=c.split('&');for(var f in e){var g=e[f],h=g.split('='),i=h[0],j=h[1];d[i]=decodeURIComponent(j);}return d},animateModal:function d(a,b,c){a.on('show.bs.modal',function(){a.removeClass('animated '+c),a.addClass('animated '+b);}),a.on('hide.bs.modal',function(){a.removeClass('animated '+b),a.addClass('animated '+c);});},showModalData:function j(a,b,c,d,e,f){var g=this,h={show:!0};1!==$('#backgroundClosingModal').val()&&(h.backdrop=!0),'object'===('undefined'==typeof c?'undefined':_typeof(c))&&(b.css(c),h=$.extend(h,c)),b.html(a),b.find('.modal').hasClass('static')&&(h.backdrop='static'),$.fn.modal.Constructor.prototype.enforceFocus=function(){$(document).off('focusin.bs.modal').on('focusin.bs.modal',$.proxy(function(a){if($(a.target).hasClass('select2-search__field'))return !0},this));};var i=b.find('.modal:first');i.one('shown.bs.modal',function(){d(i),App.Fields.Picklist.showSelect2ElementView(i.find('select.select2')),App.Fields.Picklist.showChoosenElementView(i.find('select.chzn-select')),App.Fields.Date.register(i),new App.Fields.Text.Editor(i.find('.js-editor'),{height:'5em',toolbar:'Min'});var a=i.find('.js-show-scroll');a.length&&app.showNewScrollbar(a);}),$('body').append(b),i.modal(h),g.registerModalEvents(i,f),g.showPopoverElementView(i.find('.js-popover-tooltip')),g.registerDataTables(i.find('.dataTable'));},showModalWindow:function h(a,b,c,d){if(window.parent!==window)return this.childFrame=!0,void window.parent.app.showModalWindow(a,b,c,d);var e=this;if(Window.lastModalId='modal_'+Math.random().toString(36).substr(2,9),'object'===('undefined'==typeof a?'undefined':_typeof(a))&&null!=a&&!(a instanceof $)){if(null!=a.id&&(Window.lastModalId=a.id),d=a.css,c=a.cb,b=a.url,'undefined'!==a.sendByAjaxCb)var f=a.sendByAjaxCb;a=a.data;}if('function'==typeof b?('object'===('undefined'==typeof c?'undefined':_typeof(c))&&(d=c),c=b,b=!1):'object'===('undefined'==typeof b?'undefined':_typeof(b))&&(c=function(){},d=b,b=!1),'function'!=typeof c&&(c=function(){}),'function'!=typeof f)var f=function(){};void 0!==d&&void 0!==d.modalId&&(Window.lastModalId=d.modalId);var g=$('#'+Window.lastModalId);return g.length&&g.remove(),g=$('<div></div>'),g.attr('id',Window.lastModalId).addClass('modalContainer js-modal-container'),g.one('hidden.bs.modal',function(){g.remove();var a=$('.modal-backdrop'),b=$('.modalContainer');0==b.length&&a.length&&a.remove(),0<a.length&&$('body').addClass('modal-open');}),a?e.showModalData(a,g,d,c,b,f):$.get(b).done(function(a){e.showModalData(a,g,d,c,b,f);}),g},hideModalWindow:function f(a,b){var c;if(c='object'===('undefined'==typeof a?'undefined':_typeof(a))?a:null==b?$('.modalContainer'):$('#'+b),!(0>=c.length)){'function'!=typeof a&&(a=function(){});var d=c.find('.modal');d.modal('hide');var e=$('.modal-backdrop:last');0==$('.modalContainer').length&&e.length&&e.remove(),d.one('hidden.bs.modal',a);}},registerModalController:function f(a,b,c){var d=this.childFrame?window.parent:window;void 0===a&&(a=Window.lastModalId),void 0===b&&(b=$('#'+a+' .js-modal-data'));var e=b.data('module')+'_'+b.data('view')+'_JS';if('undefined'!=typeof d[e]){var g=new d[e];'function'==typeof c&&c(b,g),g.registerEvents(b),a&&app.modalEvents[a]&&app.modalEvents[a](b,g);}if(e='Base_'+b.data('view')+'_JS','undefined'!=typeof d[e]){var h=new d[e];'function'==typeof c&&c(b,h),h.registerEvents(b),a&&app.modalEvents[a]&&app.modalEvents[a](b,h);}},registerModalEvents:function e(a,b){var c=a.find('form'),d=!1;c.hasClass('validateForm')&&(c.validationEngine(app.validationEngineOptions),d=!0),c.hasClass('sendByAjax')&&c.on('submit',function(a){var e=!0;if(a.preventDefault(),d&&0<c.data('jqv').InvalidFields.length&&(app.formAlignmentAfterValidation(c),e=!1),e){var f=$.progressIndicator({blockInfo:{enabled:!0}}),g=c.serializeFormData();AppConnector.request(g).done(function(a){return b(g,a),a.success&&a.result&&(a.result.notify&&Vtiger_Helper_Js.showMessage(a.result.notify),a.result.procesStop)?(f.progressIndicator({mode:'hide'}),!1):void(app.hideModalWindow(),f.progressIndicator({mode:'hide'}))}).fail(function(){f.progressIndicator({mode:'hide'});});}});},isHidden:function b(a){return !('none'!=a.css('display'))},isInvisible:function b(a){return !('hidden'!=a.css('visibility'))},validationEngineOptions:{scroll:!1,promptPosition:'topLeft',prettySelect:!0,useSuffix:'_chosen',usePrefix:'s2id_'},validationEngineOptionsForRecord:{scroll:!1,promptPosition:'topLeft',prettySelect:!0,useSuffix:'_chosen',usePrefix:'s2id_',validateNonVisibleFields:!0,onBeforePromptType:function c(a){var b=a.closest('.js-toggle-panel');b.find('.blockContent').is(':hidden')&&b.find('.blockHeader').click();}},formAlignmentAfterValidation:function d(a){var b=a.find('.formError:not(\'.greenPopup\'):first');if(0<b.length){var c=b.offset().top;$('html').animate({scrollTop:c-105},'slow');}},convertToDatePickerFormat:function b(a){switch(a){case'yyyy-mm-dd':return 'Y-m-d';break;case'mm-dd-yyyy':return 'm-d-Y';break;case'dd-mm-yyyy':return 'd-m-Y';break;case'yyyy.mm.dd':return 'Y.m.d';break;case'mm.dd.yyyy':return 'm.d.Y';break;case'dd.mm.yyyy':return 'd.m.Y';break;case'yyyy/mm/dd':return 'Y/m/d';break;case'mm/dd/yyyy':return 'm/d/Y';break;case'dd/mm/yyyy':return 'd/m/Y';}},convertTojQueryDatePickerFormat:function j(a){var b=0,c='-';-1!==a.indexOf('-')&&(c='-'),-1!==a.indexOf('.')&&(c='.'),-1!==a.indexOf('/')&&(c='/');var d=a.split(c);for(var b in d){var e=d[b],f=e.length;if(4==f){var g=e.substring(0,2);d[b]=g;}}var h=d.join(c);return h},getDateInDBInsertFormat:function l(a,b){var c=0,d='-';-1===a.indexOf('-')?-1===a.indexOf('.')?-1!==a.indexOf('/')&&(d='/'):d='.':d='-';var e=a.split(d),f='',g='',h='',j=b.split(d);for(c in e){var k=e[c];'dd'===k?f=j[c]:'mm'===k?g=j[c]:'yyyy'===k?h=j[c]:void 0;}return h+'-'+g+'-'+f},registerEventForDateFields:function c(a){if('undefined'==typeof a&&(a=$('body')),a=$(a),a.hasClass('dateField'))var b=a;else var b=$('.dateField',a);b.datepicker({autoclose:!0}).on('changeDate',function(a){var b=$(a.currentTarget),c=b.data('dateFormat').toUpperCase(),d=$.datepicker.formatDate(moment(a.date).format(c),a.date);b.val(d);});},registerEventForClockPicker:function e(a){var b,c;'undefined'==typeof a?(b=$('.clockPicker'),c=CONFIG.hourFormat):(b=a,c=b.data('format')),c=!(12!==c);var d={placement:'bottom',autoclose:!0,twelvehour:c,minutestep:5,ampmSubmit:!1};$('.js-clock__btn').on('click',function(a){var b=$(a.currentTarget);a.stopPropagation();var c=b.closest('.time').find('input.clockPicker');'disabled'!==c.attr('disabled')&&c.clockpicker('show');}),b.clockpicker(d);},registerDataTables:function b(a){return null!=$.fn.dataTable&&0!=a.length&&($.extend($.fn.dataTable.defaults,{language:{sLengthMenu:app.vtranslate('JS_S_LENGTH_MENU'),sZeroRecords:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfo:app.vtranslate('JS_S_INFO'),sInfoEmpty:app.vtranslate('JS_S_INFO_EMPTY'),sSearch:app.vtranslate('JS_SEARCH'),sEmptyTable:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfoFiltered:app.vtranslate('JS_S_INFO_FILTERED'),sLoadingRecords:app.vtranslate('JS_LOADING_OF_RECORDS'),sProcessing:app.vtranslate('JS_LOADING_OF_RECORDS'),oPaginate:{sFirst:app.vtranslate('JS_S_FIRST'),sPrevious:app.vtranslate('JS_S_PREVIOUS'),sNext:app.vtranslate('JS_S_NEXT'),sLast:app.vtranslate('JS_S_LAST')},oAria:{sSortAscending:app.vtranslate('JS_S_SORT_ASCENDING'),sSortDescending:app.vtranslate('JS_S_SORT_DESCENDING')}}}),a.DataTable())},getChosenElementFromSelect:function c(a){var b=a.attr('id');return $('#'+(b+'_chosen'))},getSelect2ElementFromSelect:function c(a){var b=a.attr('id');return $('#'+('select2-'+b+'-container')).closest('.select2-container')},getSelectElementFromChosen:function e(a){var b=a.attr('id'),c=b.split('_chosen'),d=c[0];return $('#'+d)},setInheritWidth:function b(a){$(a).each(function(a,b){var c=$(b).parent().width();$(b).width(c);});},showNewScrollbar:function c(a,b){if('undefined'!=typeof a&&a.length)return 'undefined'==typeof b&&(b={}),new PerfectScrollbar(a[0],b)},showNewScrollbarTopBottomRight:function e(a){if('undefined'!=typeof a&&a.length){var b=new PerfectScrollbar(a[0],{wheelPropagation:!0}),c=a.find('.ps__rail-x').first();c.css({top:0,bottom:'auto'}),c.find('.ps__thumb-x').css({top:2,bottom:'auto'});var d=new PerfectScrollbar(a[0],{wheelPropagation:!0});return [b,d]}},showNewScrollbarTopBottom:function e(a){if('undefined'!=typeof a&&a.length){var b=new PerfectScrollbar(a[0],{wheelPropagation:!0,suppressScrollY:!0}),c=new PerfectScrollbar(a[0],{wheelPropagation:!0,suppressScrollY:!0}),d=a.find('.ps__rail-x').first();d.css({top:0,bottom:'auto'}),d.find('.ps__thumb-x').css({top:2,bottom:'auto'});}},showNewScrollbarLeft:function e(a,b){if('undefined'!=typeof a&&a.length){'undefined'==typeof b&&(b={}),b.wheelPropagation=!0;var c=new PerfectScrollbar(a[0],b),d=a.children('.ps__rail-y').first();d.css({left:0,right:'auto'}),d.find('.ps__thumb-y').css({left:2,right:'auto'});}},showScrollBar:function c(a,b){return 'undefined'==typeof b&&(b={}),'undefined'==typeof b.height&&(b.height=a.css('height')),a.slimScroll(b)},vtranslate:function b(a){return a in LANG?LANG[a]:a},cacheNSKey:function b(a){return 'yf.'+a},cacheGet:function c(a,b){return a=this.cacheNSKey(a),$.jStorage.get(a,b)},cacheSet:function d(a,b,c){a=this.cacheNSKey(a),$.jStorage.set(a,b),c&&$.jStorage.setTTL(a,c);},cacheClear:function b(a){return a=this.cacheNSKey(a),$.jStorage.deleteKey(a)},moduleCacheSet:function g(a,b,c){c==null&&(c=43200000);var d=a;a=this.getModuleName()+'_'+a,this.cacheSet(a,b,c);var e='mCache'+this.getModuleName(),f=this.cacheGet(e);f=null==f?[]:f.split(','),f.push(d),this.cacheSet(e,Vtiger_Helper_Js.unique(f).join(','));},moduleCacheGet:function b(a){return this.cacheGet(this.getModuleName()+'_'+a)},moduleCacheKeys:function c(){var a='mCache'+this.getModuleName(),b=this.cacheGet(a);return b?b.split(','):[]},moduleCacheClear:function e(){var a=this,b=this.getModuleName(),c='mCache'+b,d=this.cacheGet(c);d=null==d?[]:d.split(','),$.each(d,function(c,d){a.cacheClear(b+'_'+d);}),a.cacheClear(c);},htmlEncode:function b(a){return a?$('<div />').text(a).html():''},htmlDecode:function b(a){return a?$('<div />').html(a).text():''},placeAtCenter:function b(a){a.css('position','absolute'),a.css('top',($(window).height()-a.outerHeight())/2+$(window).scrollTop()+'px'),a.css('left',($(window).width()-a.outerWidth())/2+$(window).scrollLeft()+'px');},getvalidationEngineOptions:function a(){return Object.assign({},app.validationEngineOptions)},notifyPostAjaxReady:function a(){$(document).trigger('postajaxready');},listenPostAjaxReady:function b(a){$(document).on('postajaxready',a);},setFormValues:function c(a){for(var b in a)$(b).val(a[b]);},setRTEValues:function d(a){for(var b in a){var c=CKEDITOR.instances[b];c&&c.setData(a[b]);}},getPageController:function f(){if(window.pageController)return window.pageController;var a=app.getModuleName(),b=app.getViewName(),c=app.getParentModuleName(),d=c+'_'+a+'_'+b+'_Js';'undefined'==typeof window[d]&&(d=c+'_Vtiger_'+b+'_Js'),'undefined'==typeof window[d]&&(d=a+'_'+b+'_Js');var e=$('#extendModules').val();if('undefined'==typeof window[d]&&null!=e&&(d=e+'_'+b+'_Js'),'undefined'==typeof window[d]&&(d='Vtiger_'+b+'_Js'),'undefined'!=typeof window[d]){if('function'==typeof window[d])return window.pageController=new window[d];if('object'===_typeof(window[d]))return window.pageController=window[d]}},getDecodedValue:function b(a){return $('<div></div>').html(a).text()},getCookie:function e(a){var b=document.cookie,c=b.indexOf(' '+a+'=');if(-1===c&&(c=b.indexOf(a+'=')),-1===c)b=null;else{c=b.indexOf('=',c)+1;var d=b.indexOf(';',c);-1===d&&(d=b.length),b=unescape(b.substring(c,d));}return b},setCookie:function f(a,b,c){var d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+(null==c?'':'; expires='+d.toUTCString());document.cookie=a+'='+e;},getUrlVar:function b(a){return function c(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d;});return a}()[a]},getStringDate:function f(a){var b=a.getDate(),c=a.getMonth()+1,e=a.getFullYear();return b=9>=b?'0'+b:b,c=9>=c?'0'+c:c,e+'-'+c+'-'+b},formatDate:function h(a){var b=a.getFullYear(),c=a.getMonth()+1,e=a.getDate(),d=a.getHours(),f=a.getMinutes(),g=a.getSeconds();return b+'-'+this.formatDateZ(c)+'-'+this.formatDateZ(e)+' '+this.formatDateZ(d)+':'+this.formatDateZ(f)+':'+this.formatDateZ(g)},formatDateZ:function b(a){return 9>=a?'0'+a:a},howManyDaysFromDate:function e(a){var b=a.getTime(),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()).getTime();return Math.floor((d-b)/86400000)+1},saveAjax:function g(a,b,c){var d=$.Deferred(),e={};if(e.module=app.getModuleName(),e.parent=app.getParentModuleName(),e.action='SaveAjax',a&&(e.mode=a),e.param=b,null!=c)for(var f in c)e[f]=c[f];return AppConnector.request(e).done(function(a){d.resolve(a);}).fail(function(a,b){d.reject(a,b);}),d.promise()},getMainParams:function d(a,b){if(a in CONFIG)return CONFIG[a];if(null==app.cacheParams[a]){var c=$('#'+a).val();app.cacheParams[a]=c;}var c=app.cacheParams[a];return b&&(''==c?c=[]:c=JSON.parse(c)),c},setMainParams:function c(a,b){app.cacheParams[a]=b,$('#'+a).val(b);},parseNumberToShow:function h(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:CONFIG.noOfCurrencyDecimals;void 0===b&&(b=0);var d=CONFIG.currencyGroupingSeparator,e=app.getMainParams('currencyGroupingPattern');b=parseFloat(b).toFixed(c);var f=b.toString().split('.'),a=f[0],g=f[1];return '123,456,789'===e?a=a.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,'$1'+d):'123456,789'===e?a=a.slice(0,-3)+d+a.slice(-3):'12,34,56,789'===e&&(a=a.slice(0,-3).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,'$1'+d)+d+a.slice(-3)),c?a+CONFIG.currencyDecimalSeparator+g:a},parseNumberToFloat:function e(a){var b=parseInt(CONFIG.noOfCurrencyDecimals),c=CONFIG.currencyGroupingSeparator,d=CONFIG.currencyDecimalSeparator;return (null==a||''==a)&&(a=0),a=a.toString(),a=a.split(c).join(''),a=a.replace(/\s/g,'').replace(d,'.'),parseFloat(a)},errorLog:function d(a,b,c){CONFIG.debug&&(console.warn('%cYetiForce debug mode!!!','color: red; font-family: sans-serif; font-size: 1.5em; font-weight: bolder; text-shadow: #000 1px 1px;'),'object'===('undefined'==typeof a?'undefined':_typeof(a))&&a.responseText&&(a=a.responseText),'object'===('undefined'==typeof a?'undefined':_typeof(a))&&a.statusText&&(a=a.statusText),a&&console.error(a),b&&'error'!==b&&console.error(b),c&&console.error(c));},registerModal:function b(a){'undefined'==typeof a&&(a=$('body')),a.off('click','button.showModal, a.showModal, .js-show-modal').on('click','button.showModal, a.showModal, .js-show-modal',function(a){a.preventDefault();var b=$(a.currentTarget),c=b.data('url');if('undefined'!=typeof c){b.hasClass('js-popover-tooltip')&&b.popover('hide'),b.hasClass('disabledOnClick')&&b.attr('disabled',!0);var d={url:c,cb:function e(a){var c=b.data('cb');if('undefined'!=typeof c)if(-1!==c.indexOf('.')){var d=c.split('.');'object'===_typeof(window[d[0]])&&window[d[0]][d[1]](a);}else'function'==typeof window[c]&&window[c](a);b.removeAttr('disabled');}};b.data('modalid')&&(d.id=b.data('modalid')),app.showModalWindow(d);}a.stopPropagation();});},playSound:function d(a){var b=app.getMainParams('sounds');if(b.IS_ENABLED){var c=new Audio(app.getMainParams('soundFilesPath')+b[a]);c.play();}},registerSticky:function b(){var a=$('.stick');a.each(function(){var a=$(this),b=a.data('position');if('top'==b){var c=a.offset().top-50;$('.mainBody').on('scroll',function(){$(this).scrollTop()>c?a.css({position:'fixed',top:'50px',width:a.width()}):$(this).scrollTop()<=c&&a.css({position:'',top:'',width:''});});}if('bottom'==b){var c=a.offset().top-$(window).height();$('.mainBody').on('scroll',function(){$(this).scrollTop()<c?a.css({position:'fixed',bottom:'33px',width:a.width()}):$(this).scrollTop()>=c&&a.css({position:'',bottom:'',width:''});});}});},registerMoreContent:function b(a){a.on('click',function(a){var b=$(a.currentTarget),c=b.closest('.moreContent');c.find('.teaserContent').toggleClass('d-none'),c.find('.fullContent').toggleClass('d-none'),b.text()==b.data('on')?b.text(b.data('off')):b.text(b.data('on'));});},registerMenuTextHoverEvent:function a(){$('.js-menu__item').on('mouseenter',function(){var a=this;setTimeout(function(){var b=$(a);b.is(':hover')&&b.find('.js-menu__item__text').first().addClass('u-white-space-n');},300);}).on('mouseleave',function(){var a=$(this);a.is(':hover')||a.find('.js-menu__item__text').first().removeClass('u-white-space-n');});},registerMenu:function b(){var a=this;a.keyboard={DOWN:40,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,UP:38},a.sidebarBtn=$('.js-sidebar-btn').first(),a.sidebar=$('.js-sidebar').first(),a.sidebarBtn.on('click',a.toggleSidebar.bind(a)),$('a.nav-link,[tabindex],input,select,textarea,button').on('focus',function(b){a.sidebarBtn[0]==b.target||a.sidebar.find(b.target).length||(a.sidebar.find(':focus').length?a.openSidebar():a.sidebar.hasClass('js-expand')&&a.closeSidebar());}),a.sidebar.on('mouseenter',a.openSidebar.bind(a)).on('mouseleave',a.closeSidebar.bind(a)),a.sidebar.find('.js-menu__content').on('keydown',a.sidebarKeyboard.bind(a)),a.sidebar.on('keydown',function(b){b.which==a.keyboard.ESCAPE&&(a.closeSidebar(),a.sidebarBtn.is(':tabbable')?a.sidebarBtn.focus():$(':tabbable').eq(parseInt($(':tabbable').index(a.sidebar.find(':tabbable').last()))+1).focus());}),a.sidebar.find('.js-submenu').on('shown.bs.collapse',function(a){$(a.target).find(':tabbable').first().focus();}),$('.js-submenu-toggler').on('click',function(a){$(a.currentTarget).hasClass('collapsed')||$(a.target).closest('.toggler').length||(window.location=$(a.currentTarget).attr('href'));}),a.registerMenuTextHoverEvent(),a.registerPinEvent();},openSidebar:function a(){this.sidebar.addClass('js-expand'),this.sidebarBtn.attr('aria-expanded',!0);},closeSidebar:function a(){this.sidebar.removeClass('js-expand'),this.sidebarBtn.attr('aria-expanded',!1);},toggleSidebar:function a(){this.sidebar.hasClass('js-expand')?this.closeSidebar():(this.openSidebar(),this.sidebar.find('.js-menu__content :tabbable').first().focus());},registerPinEvent:function d(){var a=this,b=a.sidebar.find('.js-menu--pin'),c=a.sidebar.closest('.js-base-container');b.on('click',function(){var d=0;c.removeClass('c-menu--animation'),'0'===b.attr('data-show')?(d='on',b.removeClass('u-opacity-muted'),c.addClass('c-menu--open'),a.sidebar.off('mouseleave mouseenter')):(b.addClass('u-opacity-muted'),c.removeClass('c-menu--open'),a.sidebar.on('mouseenter',a.openSidebar.bind(a)).on('mouseleave',a.closeSidebar.bind(a)),a.closeSidebar.bind(a)),AppConnector.request({module:'Users',action:'SaveAjax',field:'leftpanelhide',record:CONFIG.userId,value:d}).done(function(a){a.success&&a.result&&b.attr('data-show',d);}),setTimeout(function(){c.addClass('c-menu--animation');},300);});},sidebarKeyboard:function e(a){var b=$(a.target),c=$(a.target).closest('.js-submenu-toggler');if(a.which==this.keyboard.LEFT){if(b.hasClass('js-submenu-toggler')&&!b.hasClass('collapsed'))return b.click(),!1;var d=$(a.target).closest('.js-submenu').prev('.js-submenu-toggler');if(d.length&&!d.hasClass('collapsed'))return d.click().focus(),!1}else{if(b.hasClass('js-submenu-toggler')&&a.which==this.keyboard.RIGHT&&b.hasClass('collapsed')||b.hasClass('js-submenu-toggler')&&a.which==this.keyboard.SPACE)return b.click(),!1;if(a.which==this.keyboard.UP)return this.sidebar.find('.js-menu__content :tabbable').eq(parseInt(this.sidebar.find('.js-menu__content :tabbable').index(b))-1).focus(),!1;if(a.which==this.keyboard.DOWN)return this.sidebar.find('.js-menu__content :tabbable').eq(parseInt(this.sidebar.find('.js-menu__content :tabbable').index(b))+1).focus(),!1}},registerTabdrop:function d(){var a=$('.js-tabdrop');if(a.length){var b=a.find('> li');b.each(function(){$(this).removeClass('d-none');}),a.tabdrop({text:app.vtranslate('JS_MORE')});var c=a.find('> li.dropdown');c.appendTo(a),b.on('click',function(){setTimeout(function(){$(window).trigger('resize');},500);});}},getScreenHeight:function b(a){return 'undefined'==typeof a&&(a=100),$(window).height()*a/100},setCalendarHeight:function b(){var a=$('.js-base-container');if(993<$(window).width()){var c=$(window).height()-a.find('.o-calendar-container').offset().top-$('.js-footer').height()-10;return new ResizeSensor(a.find('.contentsDiv'),function(){c=$(window).height()-a.find('.o-calendar-container').offset().top-$('.js-footer').height()-10,$('#calendarview').fullCalendar('option','height',c),$('#calendarview').height(c+10);}),c}return 993>$(window).width()?'auto':void 0},clearBrowsingHistory:function a(){AppConnector.request({module:'Home',action:'BrowsingHistory'}).done(function(){$('.historyList').html('<a class="item dropdown-item" href="#" role="listitem">'+app.vtranslate('JS_NO_RECORDS')+'</a>');});},showConfirmation:function d(a,b){var c={};a&&(c=$.extend(c,a)),b&&(b=$(b),!c.title&&(c.title=b.html()+' '+(b.data('content')?b.data('content'):'')),!c.message&&(c.message=b.data('confirm')),!c.url&&(c.url=b.data('url'))),Vtiger_Helper_Js.showConfirmationBox(c).done(function(){'href'==c.type?AppConnector.request(c.url).done(function(a){window.location.href=a.result;}):'reloadTab'==c.type&&AppConnector.request(c.url).done(function(){Vtiger_Detail_Js.getInstance().reloadTabContent();});});},formatToHourText:function k(a){var b=Math.floor,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'short',d=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],e=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],f='short'===c,g=b(a),h=b(60*(a-g)),i=Math.round(60*(60*(a-g)-h)),j='';return g&&(j+=f?g+app.vtranslate('JS_H'):g+' '+app.vtranslate('JS_H_LONG')),(g||h)&&e&&(j+=f?' '+h+app.vtranslate('JS_M'):' '+h+' '+app.vtranslate('JS_M_LONG')),!1!==d&&(j+=f?' '+i+app.vtranslate('JS_S'):' '+i+' '+app.vtranslate('JS_S_LONG')),g||h||!1!==d||!e||(j+=f?'0'+app.vtranslate('JS_M'):'0 '+app.vtranslate('JS_M_LONG')),g||h||!1!==d||e||(j+=f?'0'+app.vtranslate('JS_H'):'0 '+app.vtranslate('JS_H_LONG')),j.trim()},showRecordsList:function d(a,b,c){a.view||(a.view='RecordsList'),this.showRecordsListModal(a).done(function(a){'function'==typeof c&&c(a),app.registerModalController(!1,a,b);});},showRecordsListModal:function c(a){var b=$.Deferred();return AppConnector.request(a).done(function(a){app.showModalWindow(a,function(a){b.resolve(a);});}).fail(function(a,c){b.reject(a,c);}),b.promise()},htmlToImage:function e(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{imageType:'image/png',logging:!1};a=$(a).get(0);var d=c.imageType;return delete c.imageType,html2canvas(a,c).then(function(a){var c=a.toDataURL(d);return 'function'==typeof b&&b(c),c})},decodeHTML:function c(a){var b=document.createElement('textarea');return b.innerHTML=a,b.value}};$(document).ready(function(){App.Fields.Picklist.changeSelectElementView(),app.showPopoverElementView($('body').find('.js-popover-tooltip')),app.registerSticky(),app.registerMoreContent($('body').find('button.moreBtn')),app.registerModal(),app.registerMenu(),app.registerTabdrop(),String.prototype.toCamelCase=function(){var a=this.valueOf();return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()},(/MSIE/.test(navigator.userAgent)||/Trident/.test(navigator.userAgent))&&$('textarea').resizable();var a=app.getPageController();a&&a.registerEvents();}),function(a){a.fn.getNumberFromValue=function(){return app.parseNumberToFloat(a(this).val())},a.fn.getNumberFromText=function(){return app.parseNumberToFloat(a(this).text())},a.fn.disable=function(){this.attr('disabled','disabled');},a.fn.enable=function(){this.removeAttr('disabled');},a.fn.serializeFormData=function(){var b=a(this);for(var c in CKEDITOR.instances)CKEDITOR.instances[c].updateElement();var d=b.serializeArray(),e={};d&&a(d).each(function(a,c){if(c.name in e&&'object'!==_typeof(e[c.name])){var d=b.find('[name="'+c.name+'"]');if(d.is('select')&&null!=d.attr('multiple')){var f=e[c.name];e[c.name]=[],e[c.name].push(f);}}'object'===_typeof(e[c.name])?e[c.name].push(c.value):e[c.name]=c.value;});var f=a('[data-type="autocomplete"]',a(this));return a(f).each(function(b){var c=a(f[b]);e[c.attr('name')]=c.data('value');}),e},a.expr[':'].icontains=function(b,c,d){return -1!==(b.textContent||b.innerText||a(b).text()||'').toLowerCase().indexOf(d[3].toLowerCase())},a.fn.removeTextNode=function(){a(this).contents().filter(function(){return 3==this.nodeType}).remove();},bootbox.setLocale(CONFIG.langKey);}($);
//# sourceMappingURL=app.min.js.map
