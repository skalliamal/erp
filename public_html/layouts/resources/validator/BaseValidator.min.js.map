{"version":3,"file":"BaseValidator.min.js","sources":["BaseValidator.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class(\"Vtiger_Base_Validator_Js\", {\n\tmoduleName: false,\n\t/**\n\t *Function which invokes field validation\n\t *@param accepts field element as parameter\n\t * @return error if validation fails true on success\n\t */\n\tinvokeValidation: function (field, rules, k, options) {\n\t\t//If validation engine already maked the field as error \n\t\t// we dont want to proceed\n\t\tif (typeof options !== \"undefined\") {\n\t\t\tif (options.isError == true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tvar listOfValidators = Vtiger_Base_Validator_Js.getValidator(field);\n\t\tfor (var i = 0; i < listOfValidators.length; i++) {\n\t\t\tvar validatorList = listOfValidators[i];\n\t\t\tvar validatorName = validatorList.name;\n\t\t\tvar validatorInstance = new validatorName();\n\t\t\tvalidatorInstance.setElement(field);\n\t\t\tif (validatorList.hasOwnProperty(\"params\")) {\n\t\t\t\tvar result = validatorInstance.validate(validatorList.params);\n\t\t\t} else {\n\t\t\t\tvar result = validatorInstance.validate();\n\t\t\t}\n\t\t\tif (!result) {\n\t\t\t\treturn validatorInstance.getError();\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t *Function which gets the complete list of validators based on type and data-validator\n\t *@param accepts field element as parameter\n\t * @return list of validators for field\n\t */\n\tgetValidator: function (field) {\n\t\tvar listOfValidators = [];\n\t\tvar fieldData = field.data();\n\t\tvar fieldInfo = fieldData.fieldinfo;\n\t\tif (typeof fieldInfo == 'string') {\n\t\t\tfieldInfo = JSON.parse(fieldInfo);\n\t\t}\n\t\tvar dataValidator = \"validator\";\n\t\tvar moduleEle = field.closest('form').find('[name=\"module\"]');\n\t\tif (Vtiger_Base_Validator_Js.moduleName == false && moduleEle.length > 0) {\n\t\t\tVtiger_Base_Validator_Js.moduleName = moduleEle.val();\n\t\t}\n\n\t\tvar fieldInstance = Vtiger_Field_Js.getInstance(fieldInfo);\n\t\tvar validatorsOfType = Vtiger_Base_Validator_Js.getValidatorsFromFieldType(fieldInstance);\n\t\tfor (var key in validatorsOfType) {\n\t\t\t//IE for loop fix\n\t\t\tif (!validatorsOfType.hasOwnProperty(key)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar value = validatorsOfType[key];\n\t\t\tif (value != \"\") {\n\t\t\t\tvar tempValidator = {'name': value};\n\t\t\t\tlistOfValidators.push(tempValidator);\n\t\t\t}\n\t\t}\n\t\tif (fieldData.hasOwnProperty(dataValidator)) {\n\t\t\tvar specialValidators = fieldData[dataValidator];\n\t\t\tfor (var key in specialValidators) {\n\t\t\t\t//IE for loop fix\n\t\t\t\tif (!specialValidators.hasOwnProperty(key)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar specialValidator = specialValidators[key];\n\t\t\t\tvar tempSpecialValidator = jQuery.extend({}, specialValidator);\n\t\t\t\tvar validatorOfNames = Vtiger_Base_Validator_Js.getValidatorClassName(specialValidator.name);\n\t\t\t\tif (validatorOfNames != \"\") {\n\t\t\t\t\ttempSpecialValidator.name = validatorOfNames;\n\t\t\t\t\tif (!jQuery.isEmptyObject(tempSpecialValidator)) {\n\t\t\t\t\t\tlistOfValidators.push(tempSpecialValidator);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn listOfValidators;\n\t},\n\t/**\n\t *Function which gets the list of validators based on data type of field\n\t *@param accepts fieldInstance as parameter\n\t * @return list of validators for particular field type\n\t */\n\tgetValidatorsFromFieldType: function (fieldInstance) {\n\t\tvar fieldType = fieldInstance.getType();\n\t\tvar validatorsOfType = [];\n\t\tfieldType = fieldType.charAt(0).toUpperCase() + fieldType.slice(1).toLowerCase();\n\t\tvalidatorsOfType.push(Vtiger_Base_Validator_Js.getValidatorClassName(fieldType));\n\t\treturn validatorsOfType;\n\t},\n\tgetValidatorClassName: function (validatorName) {\n\t\tvar validatorsOfType = '';\n\t\tvar className = Vtiger_Base_Validator_Js.getClassName(validatorName);\n\t\tvar fallBackClassName = Vtiger_Base_Validator_Js.getFallBackClassName(validatorName);\n\t\tif (typeof window[className] !== \"undefined\") {\n\t\t\tvalidatorsOfType = (window[className]);\n\t\t} else if (typeof window[fallBackClassName] !== \"undefined\") {\n\t\t\tvalidatorsOfType = (window[fallBackClassName]);\n\t\t}\n\t\treturn validatorsOfType;\n\t},\n\t/**\n\t *Function which gets validator className\n\t *@param accepts validatorName as parameter\n\t * @return module specific validator className\n\t */\n\tgetClassName: function (validatorName) {\n\t\tif (Vtiger_Base_Validator_Js.moduleName != false) {\n\t\t\tvar moduleName = Vtiger_Base_Validator_Js.moduleName;\n\t\t} else {\n\t\t\tvar moduleName = app.getModuleName();\n\t\t}\n\n\t\tif (moduleName == 'Events') {\n\t\t\tmoduleName = 'Calendar';\n\t\t}\n\n\t\treturn moduleName + \"_\" + validatorName + \"_Validator_Js\";\n\t},\n\t/**\n\t *Function which gets validator className\n\t *@param accepts validatorName as parameter\n\t * @return generic validator className\n\t */\n\tgetFallBackClassName: function (validatorName) {\n\t\treturn \"Vtiger_\" + validatorName + \"_Validator_Js\";\n\t}\n}, {\n\tfield: \"\",\n\terror: \"\",\n\t/**\n\t *Function which validates the field data\n\t * @return true\n\t */\n\tvalidate: function () {\n\n\t\treturn true;\n\t},\n\t/**\n\t *Function which gets error message\n\t * @return error message\n\t */\n\tgetError: function () {\n\t\tif (this.error != null) {\n\t\t\treturn this.error;\n\t\t}\n\t\treturn \"Validation Failed\";\n\t},\n\t/**\n\t *Function which sets error message\n\t * @return Instance\n\t */\n\tsetError: function (errorInfo) {\n\t\tthis.error = errorInfo;\n\t\treturn this;\n\t},\n\t/**\n\t *Function which sets field attribute of class\n\t * @return Instance\n\t */\n\tsetElement: function (field) {\n\t\tthis.field = field;\n\t\treturn this;\n\t},\n\t/**\n\t *Function which gets field attribute of class\n\t * @return Instance\n\t */\n\tgetElement: function () {\n\t\treturn this.field;\n\t},\n\t/**\n\t *Function which gets trimed field value\n\t * @return fieldValue\n\t */\n\tgetFieldValue: function () {\n\t\tvar field = this.getElement();\n\t\treturn jQuery.trim(field.val());\n\t}\n});\n"],"names":["jQuery","Class","moduleName","invokeValidation","field","rules","k","options","isError","Vtiger_Base_Validator_Js","getValidator","i","listOfValidators","length","validatorName","validatorList","name","validatorInstance","setElement","hasOwnProperty","validate","params","result","getError","fieldData","data","fieldInfo","fieldinfo","JSON","parse","closest","find","moduleEle","val","Vtiger_Field_Js","getInstance","validatorsOfType","getValidatorsFromFieldType","fieldInstance","key","push","value","specialValidators","tempSpecialValidator","extend","specialValidator","validatorOfNames","getValidatorClassName","isEmptyObject","getType","fieldType","charAt","toUpperCase","slice","toLowerCase","className","getClassName","fallBackClassName","getFallBackClassName","window","app","getModuleName","error","setError","errorInfo","getElement","getFieldValue","trim"],"mappings":"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"}