{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nVtiger_Edit_Js(\"OSSPasswords_Edit_Js\", {}, {\n\t/**\n\t * Function to register recordpresave event\n\t */\n\tregisterRecordPreSaveEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tif (typeof form === \"undefined\") {\n\t\t\tform = this.getForm();\n\t\t}\n\t\tform.on(Vtiger_Edit_Js.recordPreSave, function (e, data) {\n\t\t\tvar password = form.find('[name=\"password\"]').val();\n\t\t\tvar id = form.find('[name=\"record\"]').val();\n\t\t\tvar params = {};\n\t\t\tif (password === '**********') {\n\t\t\t\tparams = {};\n\t\t\t\tparams.data = {\n\t\t\t\t\tmodule: \"OSSPasswords\",\n\t\t\t\t\taction: \"GetPass\",\n\t\t\t\t\trecord: id\n\t\t\t\t};\n\t\t\t\tparams.async = false;\n\t\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\t\tvar response = data['result'];\n\t\t\t\t\tif (response['success']) {\n\t\t\t\t\t\tvar el = document.getElementById(\"OSSPasswords_editView_fieldName_password\");\n\t\t\t\t\t\tel.value = response['password'];\n\t\t\t\t\t\tel.onchange();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// validate password\n\t\t\t\tPasswordHelper.passwordStrength('', '');\n\t\t\t}\n\t\t\tpassword = form.find('[name=\"password\"]').val();\n\t\t\tparams = {};\n\t\t\tparams.data = {module: 'OSSPasswords', action: 'CheckPass', 'password': password, 'id': id};\n\t\t\tparams.async = false;\n\t\t\tparams.dataType = 'json';\n\t\t\t// if we doesn't have passwordError property it means that we are submitting first time\n\t\t\t// if we submitting first time we don't want to submit - we are only checking password\n\t\t\t// if password is ok then we are firing submit again with passwordError set\n\t\t\tif (typeof thisInstance.passwordError === 'undefined' || thisInstance.passwordError) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tif (data.result.success === false) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: data.result.message,\n\t\t\t\t\t\tsticker: false,\n\t\t\t\t\t\tsticker_hover: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t\tthisInstance.sending = false;\n\t\t\t\t\tthisInstance.passwordError = true;\n\t\t\t\t} else if (data.result.success === true && (typeof thisInstance.sending === 'undefined' || !thisInstance.sending)) {\n\t\t\t\t\tthisInstance.sending = true;\n\t\t\t\t\tthisInstance.passwordError = false;\n\t\t\t\t\tform.submit();\n\t\t\t\t} // else just send final request\n\t\t\t});\n\t\t});\n\t},\n\tgeneratePassword: function (e) {\n\t\tvar element = jQuery(e.currentTarget);\n\t\tvar form = element.closest('form');\n\t\tvar min = parseInt(jQuery('#minChars').val());\n\t\tvar max = parseInt(jQuery('#maxChars').val());\n\t\tvar allowedChars = jQuery('#allowedLetters').val();\n\t\tvar password = '';   // variable holding new password\n\t\t// array of allowed characters that will consist of password\n\t\t// if there there is something wrong build the password from only exclamation marks\n\t\tif (typeof (allowedChars) === \"undefined\")\n\t\t\tallowedChars = '!';\n\t\tvar chArray = allowedChars.split(',');\n\t\t// min length of a password\n\t\tif (typeof (min) === \"undefined\")\n\t\t\tmin = 10;   // default 10\n\t\t// max length of a password\n\t\tif (typeof (max) === \"undefined\")\n\t\t\tmax = 15;   // default 15\n\t\t// get the password length\n\t\tvar passlength = parseInt(Math.random() * (max - min) + min);\n\t\tvar i = 0;    // index for the loop\n\t\t// loop to get random string with *pass_length* characters\n\t\tfor (i = 0; i <= passlength; i++) {\n\t\t\tvar charIndex = parseInt(Math.random() * chArray.length);\n\t\t\tpassword += chArray[charIndex];\n\t\t}\n\t\t// get desired text field\n\t\tvar passForm = form.find('[name =\"password\"]');\n\t\t// change its value to the generated password\n\t\tpassForm.val(password);\n\t\tpassForm.trigger('change');\n\t},\n\tregisterButtonsEvents: function () {\n\t\tvar thisInstance = this;\n\t\t$('.js-generatePass').on('click', function (e) {\n\t\t\tthisInstance.generatePassword(e);\n\t\t});\n\t},\n\tregisterBasicEvents: function (container) {\n\t\tthis._super(container);\n\t\tthis.registerButtonsEvents();\n\t\tthis.registerRecordPreSaveEvent(container);\n\t}\n});\n"],"names":["Vtiger_Edit_Js","registerRecordPreSaveEvent","form","getForm","on","recordPreSave","e","find","val","id","params","data","module","action","record","async","AppConnector","request","done","response","document","getElementById","el","value","onchange","PasswordHelper","passwordStrength","password","dataType","passwordError","thisInstance","preventDefault","result","success","text","message","sticker","sticker_hover","type","Vtiger_Helper_Js","showPnotify","sending","submit","generatePassword","jQuery","currentTarget","element","closest","min","parseInt","max","allowedChars","split","Math","random","i","passlength","chArray","length","charIndex","passForm","trigger","registerButtonsEvents","$","registerBasicEvents","container","_super"],"mappings":"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"}