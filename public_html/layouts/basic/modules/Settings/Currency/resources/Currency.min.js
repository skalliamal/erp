'use strict';

jQuery.Class('Settings_Currency_Js',{currencyInstance:!1,triggerAdd:function c(a){a.stopPropagation();var b=Settings_Currency_Js.currencyInstance;b.showEditView();},triggerEdit:function d(a,b){a.stopPropagation();var c=Settings_Currency_Js.currencyInstance;c.showEditView(b);},triggerDefault:function c(a,b){a.stopPropagation(),Vtiger_Helper_Js.showConfirmationBox({message:app.vtranslate('JS_CURRENCY_DEFAULT_CONFIRMED')}).done(function(){var a=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});app.saveAjax('setDefault',null,{record:b}).done(function(){a.progressIndicator({mode:'hide'}),Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_CURRENCY_DETAILS_SAVED')}),Settings_Currency_Js.currencyInstance.loadListViewContents();});});},triggerDelete:function e(a,b){a.stopPropagation();var c=jQuery(a.currentTarget),d=c.closest('tr'),f=Settings_Currency_Js.currencyInstance;f.transformEdit(b).done(function(a){var c=function(){var a=jQuery('#transformCurrency');App.Fields.Picklist.showSelect2ElementView(a.find('select.select2')),a.on('submit',function(c){c.preventDefault();var e=a.find('select[name="transform_to_id"]');f.deleteCurrency(b,e,d);});};app.showModalWindow(a,function(a){'function'==typeof c&&c(a);},{width:'500px'});});}},{init:function a(){Settings_Currency_Js.currencyInstance=this;},showEditView:function f(a){var b=this,c=jQuery.Deferred(),d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),e={};return e.module=app.getModuleName(),e.parent=app.getParentModuleName(),e.view='EditAjax',e.record=a,AppConnector.request(e).done(function(a){var c=function(){var a=jQuery('#editCurrency'),c=a.find('[name="record"]').val();App.Fields.Picklist.showSelect2ElementView(a.find('select.select2'));var d=a.find('[name="currency_status"]').is(':checked');''!=c&&d&&b.registerCurrencyStatusChangeEvent(a),b.registerCurrencyNameChangeEvent(a);var e=app.validationEngineOptions;e.onValidationComplete=function(a,c){if(c)return b.saveCurrencyDetails(a),c},a.validationEngine(e),a.on('submit',function(a){a.preventDefault();});};d.progressIndicator({mode:'hide'}),app.showModalWindow(a,function(a){'function'==typeof c&&c(a);},{width:'600px'});}).fail(function(a){d.progressIndicator({mode:'hide'}),c.reject(a);}),c.promise()},registerCurrencyStatusChangeEvent:function b(a){a.find('[name="currency_status"]').on('change',function(b){var c=jQuery(b.currentTarget);c.is(':checked')?a.find('div.transferCurrency').addClass('d-none'):a.find('div.transferCurrency').removeClass('d-none');});},registerCurrencyNameChangeEvent:function c(a){var b=a.find('select[name="currency_name"]');b.on('change',function(){var c=b.find('option:selected');a.find('[name="currency_code"]').val(c.data('code')),a.find('[name="currency_symbol"]').val(c.data('symbol'));});},saveCurrencyDetails:function e(a){var b=this,c=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),d=a.serializeFormData();d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='SaveAjax',d.mode='save',AppConnector.request(d).done(function(a){if(a.success){c.progressIndicator({mode:'hide'}),app.hideModalWindow();var d={};d.text=app.vtranslate('JS_CURRENCY_DETAILS_SAVED'),Settings_Vtiger_Index_Js.showMessage(d),b.loadListViewContents();}}).fail(function(){c.progressIndicator({mode:'hide'});});},loadListViewContents:function d(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.parent=app.getParentModuleName(),c.view='List',AppConnector.request(c).done(function(a){b.progressIndicator({mode:'hide'}),jQuery('#listViewContents').html(a);}).fail(function(){b.progressIndicator({mode:'hide'});});},transformEdit:function d(a){var b=jQuery.Deferred(),c={};return c.module=app.getModuleName(),c.parent=app.getParentModuleName(),c.view='TransformEditAjax',c.record=a,AppConnector.request(c).done(function(a){b.resolve(a);}).fail(function(a,c){b.reject(a,c);}),b.promise()},deleteCurrency:function f(a,b,c){var d=b.find('option:selected').val(),e={};e.module=app.getModuleName(),e.parent=app.getParentModuleName(),e.action='DeleteAjax',e.record=a,e.transform_to_id=d,AppConnector.request(e).done(function(){app.hideModalWindow();var a={};a.text=app.vtranslate('JS_CURRENCY_DELETED_SUCCESSFULLY'),Settings_Vtiger_Index_Js.showMessage(a),c.fadeOut('slow').remove();});},triggerDisplayTypeEvent:function c(){var a=app.cacheGet('widthType','narrowWidthType');if(a){var b=jQuery('.listViewEntriesTable').find('td,th');b.attr('class',a);}},registerRowClick:function b(){var a=this;jQuery('#listViewContents').on('click','.listViewEntries',function(b){var c=jQuery(b.currentTarget);0>=c.find('.fas fa-edit ').length||a.showEditView(c.data('id'));});},registerEvents:function a(){this.registerRowClick();}}),jQuery(document).ready(function(){var a=new Settings_Currency_Js;a.registerEvents();});
//# sourceMappingURL=Currency.min.js.map
