'use strict';

$.Class('Settings_LayoutEditor_Js',{},{updatedBlockSequence:{},reactiveFieldsList:[],inActiveFieldsList:!1,updatedBlockFieldsList:[],updatedBlocksList:[],blockNamesList:[],setInactiveFieldsList:function d(){var e=this,t=$('#layoutEditorContainer').find('.contents'),a=t.find('.inActiveFieldsArray');0<a.length&&(e.inActiveFieldsList=JSON.parse(a.val()));},makeBlocksListSortable:function d(){var e=this,t=$('#layoutEditorContainer').find('.contents'),a=t.find('.blockSortable');t.sortable({containment:t,items:a,revert:!0,tolerance:'pointer',cursor:'move',update:function t(){e.updateBlockSequence();}});},updateBlockSequence:function i(){var e=this,t=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),a=JSON.stringify(e.updateBlocksListByOrder()),d={};d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Block',d.mode='updateSequenceNumber',d.sequence=a,AppConnector.request(d).done(function(){t.progressIndicator({mode:'hide'});var e={};e.text=app.vtranslate('JS_BLOCK_SEQUENCE_UPDATED'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(){t.progressIndicator({mode:'hide'});});},updateBlocksListByOrder:function a(){var e=this,t=$('#layoutEditorContainer').find('.contents');return t.find('.editFieldsTable.blockSortable').each(function(t,a){var d=$(a),i=d.data('blockId'),o=d.data('sequence'),l=t+1;l!=o&&d.data('sequence',l),e.updatedBlockSequence[i]=l;}),e.updatedBlockSequence},registerRelatedListEvents:function o(){var t=this,a=$('#relatedTabOrder'),e=a.find('.relatedTabModulesList'),d=e.find('ul.relatedModulesList'),i=App.Fields.Picklist.showSelect2ElementView(e.find('.select2_container'),{sortable:!0,sortableCb:function i(e){var a=e.closest('.relatedModule'),d=t.updateSelectedFields(e);}});a.on('click','.inActiveRelationModule',function(a){var e=$(a.currentTarget),d=e.closest('.relatedModule');d.find('.activeRelationModule').removeClass('d-none').show(),e.hide(),t.changeStatusRelatedModule(d.data('relation-id'),!1);}),a.on('click','.activeRelationModule',function(a){var e=$(a.currentTarget),d=e.closest('.relatedModule');d.find('.inActiveRelationModule').removeClass('d-none').show(),e.hide(),t.changeStatusRelatedModule(d.data('relation-id'),!0);}),a.on('click','.removeRelation',function(a){var e=$(a.currentTarget),d=e.closest('.relatedModule');t.removeRelation(d);}),a.on('click','.addToFavorites',function(a){var e=$(a.currentTarget);t.changeStateFavorites(e);}),a.on('change','.relatedViewType',function(){var e=$(this),a=e.val();return a?void(e.validationEngine('hide'),t.changeRelatedViewType(e)):(e.validationEngine('showPrompt',app.vtranslate('JS_PLEASE_SELECT_ATLEAST_ONE_OPTION')),!1)}),a.on('click','.addRelation',function(d){var e=$(d.currentTarget),i=e.closest('#relatedTabOrder'),o=i.closest('.contentsDiv'),l=a.find('.addRelationContainer').clone(!0,!0),n=function(a){App.Fields.Picklist.showSelect2ElementView(a.find('select')),a.find('.relLabel').val(a.find('.target option:selected').val()),a.on('change','.target',function(t){var e=$(t.currentTarget);a.find('.relLabel').val(e.find('option:selected').val());}),a.on('click','.addButton',function(){var e=a.find('form').serializeFormData(),d={};d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Relation',d.mode='addRelation',$.extend(d,e),AppConnector.request(d).done(function(){t.getRelModuleLayoutEditor(i.find('[name="layoutEditorRelModules"]').val()).done(function(e){o.html(e),t.registerEvents();});});});};app.showModalWindow(l,function(e){'function'==typeof n&&n(e);});});},getSelectedFields:function a(e){var t=[];return e.find(':selected').each(function(){t.push({id:$(this).val(),name:$(this).data('field-name')});}),t},makeRelatedModuleSortable:function d(){var e=this,t=$('.relatedModulesList'),a=t.find('.relatedModule');t.sortable({containment:t,items:a,handle:'.mainBlockTableLabel',revert:!0,tolerance:'pointer',cursor:'move',update:function t(){e.updateSequenceRelatedModule();}});},changeRelatedViewType:function a(e){var t=e.closest('.relatedModule');AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),action:'Relation',mode:'updateRelatedViewType',relationId:t.data('relation-id'),types:e.val()}).done(function(e){e.success?Settings_Vtiger_Index_Js.showMessage({text:e.result.text}):Settings_Vtiger_Index_Js.showMessage({type:'error',text:e.error.message});}).fail(function(e){Settings_Vtiger_Index_Js.showMessage({text:e.message});});},changeStateFavorites:function o(e){var a=e.closest('.relatedModule'),d=1==e.data('state')?0:1,i={};i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.action='Relation',i.mode='updateStateFavorites',i.relationId=a.data('relation-id'),i.status=d,AppConnector.request(i).done(function(){e.data('state',d),e.find('[data-fa-i2svg]').each(function(){$(this).hasClass('d-none')?$(this).removeClass('d-none'):$(this).addClass('d-none');}),Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_SAVE_NOTIFY_OK')});}).fail(function(e){var t={};t.text=e,Settings_Vtiger_Index_Js.showMessage(t);});},changeStatusRelatedModule:function d(e,t){var a={};a.module=app.getModuleName(),a.parent=app.getParentModuleName(),a.action='Relation',a.mode='changeStatusRelation',a.relationId=e,a.status=t,AppConnector.request(a).done(function(){var e={};e.text=t?app.vtranslate('JS_SAVED_CHANGE_STATUS_1'):app.vtranslate('JS_SAVED_CHANGE_STATUS_0'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(e){var t={};t.text=e,t.type='error',Settings_Vtiger_Index_Js.showMessage(t);});},removeRelation:function d(e){var a=app.vtranslate('JS_DELETE_RELATION_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:a}).done(function(){var t={};t.module=app.getModuleName(),t.parent=app.getParentModuleName(),t.action='Relation',t.mode='removeRelation',t.relationId=e.data('relation-id'),AppConnector.request(t).done(function(){var t={};t.text=app.vtranslate('JS_REMOVE_RELATION_OK'),e.remove(),Settings_Vtiger_Index_Js.showMessage(t);}).fail(function(){Settings_Vtiger_Index_Js.showMessage({text:a,type:'error'});});}).fail(function(){});},updateSequenceRelatedModule:function o(){var t=[],a=$('.relatedModulesList'),d={},i=$.progressIndicator({position:'html',blockInfo:{enabled:!0}});a.find('.relatedModule').each(function(e,a){var d=$(a).data('relationId');t.push({relationId:d,index:e});}),d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Relation',d.mode='updateSequenceRelatedModule',d.modules=t,AppConnector.request(d).done(function(){i.progressIndicator({mode:'hide'});var e={};e.text=app.vtranslate('JS_UPDATE_SEQUENCE'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(e){i.progressIndicator({mode:'hide'});var t={};t.text=e,Settings_Vtiger_Index_Js.showMessage(t);});},updateSelectedFields:function l(e){var t=this,a={},d=$(e).closest('.relatedModule'),i=$.progressIndicator({position:'html',blockInfo:{enabled:!0}});if('inventory'==$(e).data('type')){a.inventory=!0;var o=$(e).val();}else var o=t.getSelectedFields($(e));a.module=app.getModuleName(),a.parent=app.getParentModuleName(),a.action='Relation',a.mode='updateSelectedFields',a.relationId=d.data('relation-id'),a.fields=o,AppConnector.request(a).done(function(){i.progressIndicator({mode:'hide'});var e={};e.text=app.vtranslate('JS_UPDATED_FIELD_LIST_MODULE_RELATED'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(e){i.progressIndicator({mode:'hide'});var t={};t.text=e,Settings_Vtiger_Index_Js.showMessage(t);});},makeFieldsListSortable:function d(){var t=this,e=$('#layoutEditorContainer').find('.contents'),a=e.find('.editFieldsTable');a.each(function(){var e=$(this).closest('.moduleBlocks');$(this).find('ul[name=sortable1], ul[name=sortable2]').sortable({containment:e,revert:!0,tolerance:'pointer',cursor:'move',connectWith:e.find('.connectedSortable'),update:function o(a,e){var d=e.item;if(d.closest('.moduleBlocks').hasClass('inventoryBlock'))t.showSaveFieldSequenceButton(d.closest('.editFieldsTable'));else if(t.showSaveFieldSequenceButton(t.getDetailViewLayout()),t.createUpdatedBlocksList(d),e.sender){var i=e.sender.closest('.editFieldsTable');t.reArrangeBlockFields(i);}}});});},getDetailViewLayout:function e(){return $('#detailViewLayout')},getInventoryViewLayout:function e(){return $('#inventoryViewLayout')},showSaveFieldSequenceButton:function i(e){var t=this,a=e.find('.saveFieldSequence');if(app.isHidden(a)||app.isInvisible(a)){a.hasClass('inventorySequence')||(t.updatedBlocksList=[],t.updatedBlockFieldsList=[]),a.removeClass('d-none'),a.removeClass('invisible');var d={};d.text=app.vtranslate('JS_SAVE_THE_CHANGES_TO_UPDATE_FIELD_SEQUENCE'),Settings_Vtiger_Index_Js.showMessage(d);}},hideSaveFieldSequenceButton:function a(){var e=$('#detailViewLayout'),t=e.find('.saveFieldSequence');t.addClass('d-none');},createUpdatedBlocksList:function i(e){var t=this,a=e.closest('.editFieldsTable'),d=a.data('blockId');-1==$.inArray(d,t.updatedBlocksList)&&t.updatedBlocksList.push(d),t.reArrangeBlockFields(a);},reArrangeBlockFields:function o(e){var t=e.find('ul[name=sortable1]'),a=e.find('ul[name=sortable2]');if(t.children().length<a.children().length){var d=a.children(':last');t.append(d);}else if(t.children().length>a.children().length+1){var i=t.children(':last');a.append(i);}},createUpdatedBlockFieldsList:function u(){var e=this,t=$('#layoutEditorContainer').find('.contents');for(var a in e.updatedBlocksList){var d=e.updatedBlocksList[a],i=t.find('.block_'+d),o=i.find('ul[name=sortable1]'),l=o.find('.editFields'),n=1;l.each(function(t,a){var i=$(a),o=i.data('fieldId');e.updatedBlockFieldsList.push({fieldid:o,sequence:n,block:d}),n+=2;});var r=i.find('ul[name=sortable2]'),s=r.find('.editFields'),c=2;s.each(function(t,a){var i=$(a),o=i.data('fieldId');e.updatedBlockFieldsList.push({fieldid:o,sequence:c,block:d}),c+=2;});}},registerFieldSequenceSaveClick:function a(){var e=this,t=$('#detailViewLayout');t.on('click','.saveFieldSequence',function(){e.hideSaveFieldSequenceButton(),e.createUpdatedBlockFieldsList(),e.updateFieldSequence();});},updateFieldSequence:function d(){var e=this,t=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),a={};a.module=app.getModuleName(),a.parent=app.getParentModuleName(),a.action='Field',a.mode='move',a.updatedFields=e.updatedBlockFieldsList,AppConnector.request(a).done(function(){t.progressIndicator({mode:'hide'}),window.location.reload();var e={};e.text=app.vtranslate('JS_FIELD_SEQUENCE_UPDATED'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(){t.progressIndicator({mode:'hide'});});},registerAddCustomFieldEvent:function d(){var e=this,t=$('#layoutEditorContainer'),a=t.find('.contents');a.find('.addCustomField').on('click',function(a){var d=$(a.currentTarget).closest('.editFieldsTable').data('blockId'),i=t.find('.createFieldModal').clone(!0,!0);i.removeClass('d-none').show();var o=function(t){App.Fields.Picklist.showSelect2ElementView(t.find('select'),{width:'100%'});var a=t.find('.createCustomFieldForm');a.attr('id','createFieldForm'),App.Fields.Picklist.showSelect2ElementView(a.find('[name="pickListValues"]'),{tags:!0,tokenSeparators:[',']}),e.registerFieldTypeChangeEvent(a),e.registerTableTypeChangeEvent(a),e.registerMultiReferenceFieldsChangeEvent(a),e.registerMultiReferenceFilterFieldChangeEvent(a);var i=app.getvalidationEngineOptions(!0);i.onValidationComplete=function(t,a){if(a){var o=$('[name="fieldType"]',t).val(),l=$('[name="fieldName"]',t).val();if('Picklist'==o||'MultiSelectCombo'==o){var n=$('#pickListValues',t),r=n.val(),s=r.length,c=/["]/;if('status'===l.toLowerCase()||'picklist'===l.toLowerCase()){var u=app.vtranslate('JS_RESERVED_PICKLIST_NAME');return $('[name="fieldName"]',t).validationEngine('showPrompt',u,'error','bottomLeft',!0),!1}for(var m=0;m<r.length;m++)if(c.test(r[m])){var g=app.getSelect2ElementFromSelect(n),u=app.vtranslate('JS_SPECIAL_CHARACTERS')+' " '+app.vtranslate('JS_NOT_ALLOWED');return g.validationEngine('showPrompt',u,'error','bottomLeft',!0),!1}var v=$.map(r,function(e){return e.toLowerCase()}),f=$.uniqueSort(v),p=f.length;if(0<s-p){var g=app.getSelect2ElementFromSelect(n),u=app.vtranslate('JS_DUPLICATES_VALUES_FOUND');return g.validationEngine('showPrompt',u,'error','bottomLeft',!0),!1}}if('Tree'==o||'CategoryMultipicklist'==o){var h=t.find('select.TreeList');if('-'==h.val()){var u=app.vtranslate('JS_FIELD_CAN_NOT_BE_EMPTY');return t.find('.TreeList').validationEngine('showPrompt',u,'error','bottomLeft',!0),!1}}var E=t.find(':submit');E.attr('disabled','disabled'),e.addCustomField(d,t).done(function(a){var d=a.result,i={};if(a.success)app.hideModalWindow(),i.text=app.vtranslate('JS_CUSTOM_FIELD_ADDED'),Settings_Vtiger_Index_Js.showMessage(i),e.showCustomField(d);else{a.error.message;Vtiger_Helper_Js.showPnotify({title:513==a.error.code?t.find('.fieldLabelForm').text():t.find('.fieldNameForm').text(),type:'error',text:a.error.message}),E.removeAttr('disabled');}});}return !1},a.validationEngine(i);};app.showModalWindow(i,function(e){'function'==typeof o&&o(e);},{width:'1000px'});});},setBlocksListArray:function d(e){var t=this;t.blockNamesList=[];var a=e.find('[name="beforeBlockId"]');a.find('option').each(function(e,a){var d=$(a),i=d.data('label');t.blockNamesList.push(i);});},addCustomField:function l(e,t){var d=t.closest('#'+Window.lastModalId).find('.modal-header h3'),i=$.Deferred();d.progressIndicator({smallLoadingImage:!0,imageContainerCss:{display:'inline',"margin-left":'18%',position:'absolute'}});var o=t.serializeFormData();return o.module=app.getModuleName(),o.parent=app.getParentModuleName(),o.action='Field',o.mode='add',o.blockid=e,o.sourceModule=$('#selectedModuleName').val(),AppConnector.request(o).done(function(e){d.progressIndicator({mode:'hide'}),i.resolve(e);}).fail(function(e){d.progressIndicator({mode:'hide'}),i.reject(e);}),i.promise()},registerTableTypeChangeEvent:function e(t){t.find('[name="fieldTypeList"]').on('change',function(a){$(a.currentTarget);t.find('[name="fieldName"]').closest('.form-group').toggleClass('d-none');});},registerFieldTypeChangeEvent:function l(t){var a=this,e=t.find('[name="fieldLength"]'),d=[{name:'DecimalMaxLength'}],i=[{name:'MaxLength'}],o=[{name:'FloatingDigits'}];e.data('validator',i),t.find('[name="fieldType"]').on('change',function(l){var e=$(l.currentTarget),n=t.find('[name="fieldLength"]'),r=e.find('option:selected');if(t.find('.supportedType').addClass('d-none'),r.data('lengthsupported')&&(t.find('.lengthsupported').removeClass('d-none'),n.data('validator',i)),r.data('decimalsupported')){var s=t.find('.decimalsupported');s.removeClass('d-none');var c=s.find('[name="decimal"]'),u=r.data('maxfloatingdigits');'undefined'!=typeof u&&(c.data('validator',o),n.data('validator',d)),r.data('decimalreadonly')?c.val(u).attr('readonly',!0):c.removeAttr('readonly').val('');}if(r.data('predefinedvalueexists')){var m=t.find('.preDefinedValueExists');m.removeClass('d-none');}if(r.data('picklistoption')){var g=t.find('.picklistOption');g.removeClass('d-none');}'Related1M'==r.val()&&t.find('.preDefinedModuleList').removeClass('d-none'),('Tree'==r.val()||'CategoryMultipicklist'==r.val())&&t.find('.preDefinedTreeList').removeClass('d-none'),'MultiReferenceValue'==r.val()&&(t.find('.preMultiReferenceValue').removeClass('d-none'),a.loadMultiReferenceFields(t));});},showCustomField:function u(e){var t=this,a=$('#layoutEditorContainer').find('.contents'),d=a.find('.block_'+e.blockid),i=a.find('.newCustomFieldCopy').clone(!0,!0),o=i.find('div.marginLeftZero.border1px');o.addClass('opacity editFields').attr('data-field-id',e.id).attr('data-block-id',e.blockid),o.find('.deleteCustomField, .saveFieldDetails').attr('data-field-id',e.id),o.find('.fieldLabel').html(e.label+' ['+e.name+']'),o.find('#relatedFieldValue').val(e.name).prop('id','relatedFieldValue'+e.id),o.find('.copyFieldLabel').attr('data-target','relatedFieldValue'+e.id),t.registerCopyClipboard(o),e.customField||o.find('.deleteCustomField').remove(),-1==$.inArray(e.type,['string','phone','currency','url','integer','double'])&&o.find('.maskField').remove();var l=d.find('.blockFieldsList'),n=l.find('ul[name=sortable1]'),r=n.children().length,s=l.find('ul[name=sortable2]'),c=s.children().length;r>c?s.append(i.removeClass('d-none newCustomFieldCopy')):n.append(i.removeClass('d-none newCustomFieldCopy')),t.makeFieldsListSortable();},registerAddCustomBlockEvent:function e(){var t=this,a=$('#layoutEditorContainer').find('.contents');a.find('.addCustomBlock').on('click',function(d){var e=a.find('.addBlockModal').clone(!0,!0),i=function(e){e.find('.addBlockModal').removeClass('d-none').show(),App.Fields.Picklist.showSelect2ElementView(e.find('select'));var a=e.find('.addCustomBlockForm');t.setBlocksListArray(a);var i=a.find('[name="label"]'),o=app.validationEngineOptions;o.onValidationComplete=function(e,a){if(a){var o=e.serializeFormData();if(-1==$.inArray(o.label,t.blockNamesList))return t.saveBlockDetails(e).done(function(a){var d={};if(a.success){var i=a.result;t.displayNewCustomBlock(i),t.updateNewSequenceForBlocks(i.sequenceList),t.appendNewBlockToBlocksList(i,e),t.makeFieldsListSortable(),d.text=app.vtranslate('JS_CUSTOM_BLOCK_ADDED');}else d.text=a.error.message,d.type='error';Settings_Vtiger_Index_Js.showMessage(d);}),app.hideModalWindow(),a;var l=app.vtranslate('JS_BLOCK_NAME_EXISTS');return i.validationEngine('showPrompt',l,'error','topLeft',!0),void d.preventDefault()}},a.validationEngine(o),a.on('submit',function(t){t.preventDefault();});};app.showModalWindow(e,function(e){'function'==typeof i&&i(e);},{width:'1000px'});});},saveBlockDetails:function o(e){var a=$.Deferred(),d=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),i=e.serializeFormData();return i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.sourceModule=$('#selectedModuleName').val(),i.action='Block',i.mode='save',AppConnector.request(i).done(function(e){d.progressIndicator({mode:'hide'}),a.resolve(e);}).fail(function(e){d.progressIndicator({mode:'hide'}),a.reject(e);}),a.promise()},displayNewCustomBlock:function l(e){var a=$('#layoutEditorContainer').find('.contents'),d=e.beforeBlockId,i=a.find('.block_'+d),o=a.find('.newCustomBlockCopy').clone(!0,!0);o.data('blockId',e.id).find('.blockLabel').append($('<strong>'+e.label+'</strong>')),o.find('.blockVisibility').data('blockId',e.id),e.isAddCustomFieldEnabled&&o.find('.addCustomField').removeClass('d-none'),i.after(o.removeClass('d-none newCustomBlockCopy').addClass('editFieldsTable block_'+e.id)),o.find('.blockFieldsList').sortable({connectWith:'.blockFieldsList'});},updateNewSequenceForBlocks:function a(e){var t=$('#layoutEditorContainer').find('.contents');$.each(e,function(e,a){t.find('.block_'+e).data('sequence',a);});},appendNewBlockToBlocksList:function o(e){var t=$('#layoutEditorContainer').find('.contents'),a=t.find('.addBlockModal'),d=a.find('[name="beforeBlockId"]'),i=$('<option>',{value:e.id,text:e.label});d.append(i.attr('data-label',e.label));},removeBlockFromBlocksList:function i(e){var t=$('#layoutEditorContainer').find('.contents'),a=t.find('.addBlockModal'),d=a.find('[name="beforeBlockId"]');d.find('option[value="'+e+'"]').remove();},registerBlockVisibilityEvent:function a(){var t=this,e=$('#layoutEditorContainer').find('.contents');e.on('click','li.blockVisibility',function(a){var e=$(a.currentTarget),d=e.data('visible');'0'==d?(e.find('.fa-check').removeClass('d-none'),e.data('visible','1')):(e.find('.fa-check').addClass('d-none'),e.data('visible','0')),t.updateBlockStatus(e);});},updateBlockStatus:function o(e){var a=e.data('visible'),d=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),i={};i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.sourceModule=$('#selectedModuleName').val(),i.action='Block',i.mode='save',i.blockid=e.data('blockId'),i.display_status=a,AppConnector.request(i).done(function(){d.progressIndicator({mode:'hide'});var e={};e.text='1'==a?app.vtranslate('JS_BLOCK_VISIBILITY_SHOW'):app.vtranslate('JS_BLOCK_VISIBILITY_HIDE'),Settings_Vtiger_Index_Js.showMessage(e);}).fail(function(){d.progressIndicator({mode:'hide'});});},registerInactiveFieldsEvent:function a(){var t=this,e=$('#layoutEditorContainer').find('.contents');e.on('click','li.inActiveFields',function(a){var d=$(a.currentTarget),i=d.closest('.editFieldsTable'),o=i.data('blockId');if($.isEmptyObject(t.inActiveFieldsList[o])){var l={};l.text=app.vtranslate('JS_NO_HIDDEN_FIELDS_EXISTS'),l.type='error',Settings_Vtiger_Index_Js.showMessage(l);}else{var n=e.find('.inactiveFieldsModal').clone(!0,!0),r=function(e){e.find('.inactiveFieldsModal').removeClass('d-none').show(),t.reactiveFieldsList=[];var a=e.find('.inactiveFieldsForm');t.showHiddenFields(o,a),a.on('submit',function(d){t.createReactivateFieldslist(o,a),t.reActivateHiddenFields(i),app.hideModalWindow(),d.preventDefault();});};app.showModalWindow(n,function(e){'function'==typeof r&&r(e);},{width:'1000px'});}});},showHiddenFields:function d(e,t){var a=this;$.each(a.inActiveFieldsList[e],function(e,a){var d=$('<div class="col-md-4 marginLeftZero padding-bottom1per checkbox"><label class="">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" class="inActiveField" value="'+e+'" />&nbsp;'+a+'</label></div>');t.find('.inActiveList').append(d);});},createReactivateFieldslist:function d(e,t){var a=this;t.find('.inActiveField').each(function(t,d){var i=$(d),o=i.val();i.is(':checked')&&(delete a.inActiveFieldsList[e][o],a.reactiveFieldsList.push(o));});},reActivateHiddenFields:function i(e){var t=this,a=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),d={};d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Field',d.mode='unHide',d.blockId=e.data('blockId'),d.fieldIdList=JSON.stringify(t.reactiveFieldsList),AppConnector.request(d).done(function(e){for(var d in e.result)t.showCustomField(e.result[d]);a.progressIndicator({mode:'hide'});var i={};i.text=app.vtranslate('JS_SELECTED_FIELDS_REACTIVATED'),Settings_Vtiger_Index_Js.showMessage(i);}).fail(function(){a.progressIndicator({mode:'hide'});});},registerDeleteCustomBlockEvent:function d(){var e=this,t=$('#layoutEditorContainer').find('.contents'),a=t.find('.editFieldsTable');t.on('click','li.deleteCustomBlock',function(t){var a=$(t.currentTarget),d=a.closest('div.editFieldsTable'),i=d.data('blockId'),o=app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');Vtiger_Helper_Js.showConfirmationBox({message:o}).done(function(){e.deleteCustomBlock(i);}).fail(function(){});});},deleteCustomBlock:function i(e){var t=this,a=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),d={};d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Block',d.mode='delete',d.blockid=e,AppConnector.request(d).done(function(d){a.progressIndicator({mode:'hide'});var i={};d.success?(t.removeDeletedBlock(e),t.removeBlockFromBlocksList(e),i.text=app.vtranslate('JS_CUSTOM_BLOCK_DELETED')):(i.text=d.error.message,i.type='error'),Settings_Vtiger_Index_Js.showMessage(i);}).fail(function(){a.progressIndicator({mode:'hide'});});},removeDeletedBlock:function d(e){var t=$('#layoutEditorContainer').find('.contents'),a=t.find('.block_'+e);a.fadeOut('slow').remove();},registerDeleteCustomFieldEvent:function a(e){var t=this;'undefined'==typeof e&&(e=$('#layoutEditorContainer').find('.contents')),e.find('.deleteCustomField').on('click',function(a){var e=$(a.currentTarget),d=e.data('fieldId'),i=app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');Vtiger_Helper_Js.showConfirmationBox({message:i}).done(function(){t.deleteCustomField(d).done(function(){var a=e.closest('div.editFields'),d=a.data('blockId');a.parent().fadeOut('slow').remove();var i=$('#block_'+d);t.reArrangeBlockFields(i);var o={};o.text=app.vtranslate('JS_CUSTOM_FIELD_DELETED'),Settings_Vtiger_Index_Js.showMessage(o);}).fail(function(){});}).fail(function(){});});},deleteCustomField:function o(e){var a=$.Deferred(),d=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),i={};return i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.action='Field',i.mode='delete',i.fieldid=e,AppConnector.request(i).done(function(e){d.progressIndicator({mode:'hide'}),a.resolve(e);}).fail(function(){d.progressIndicator({mode:'hide'}),a.reject();}),a.promise()},registerFieldDetailsChange:function t(e){e.find('[name="mandatory"]').on('change',function(t){var e=$(t.currentTarget);if('readonly'!==e.attr('readonly')){var a=e.closest('.fieldDetailsForm'),d=a.find('[name="quickcreate"]').filter(':checkbox').not('.optionDisabled'),i=a.find('[name="presence"]').filter(':checkbox').not('.optionDisabled');e.is(':checked')?(d.attr('checked',!0).attr('readonly','readonly'),i.attr('checked',!0).attr('readonly','readonly')):(d.removeAttr('readonly'),i.removeAttr('readonly'));}}),e.find('[name="defaultvalue"]').on('change',function(t){var e=$(t.currentTarget),a=e.closest('.checkbox').find('.defaultValueUi'),d=a.find('[name="fieldDefaultValue"]');e.is(':checked')?(a.removeClass('zeroOpacity'),d.removeAttr('disabled'),d.is('select')&&d.trigger('chosen:updated')):(d.attr('disabled','disabled'),a.addClass('zeroOpacity'));});},relatedModulesTabClickEvent:function i(){var e=this,t=$('#layoutEditorContainer').find('.contents'),a=t.find('#relatedTabOrder'),d=t.find('.relatedListTab');d.on('click',function(){0<a.find('.relatedTabModulesList').length||e.showRelatedTabModulesList(a);});},showRelatedTabModulesList:function d(e){var t=this,a={};a.module=app.getModuleName(),a.parent=app.getParentModuleName(),a.sourceModule=$('#selectedModuleName').val(),a.view='Index',a.mode='showRelatedListLayout',AppConnector.request(a).done(function(a){e.html(a),0<$(a).find('.relatedListContainer').length&&(t.makeRelatedModuleSortable(),t.registerRelatedListEvents());}).fail(function(){});},getModuleLayoutEditor:function o(e){var a=$.Deferred(),d=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),i={};return i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.view='Index',i.sourceModule=e,AppConnector.requestPjax(i).done(function(e){d.progressIndicator({mode:'hide'}),a.resolve(e);}).fail(function(){d.progressIndicator({mode:'hide'}),a.reject();}),a.promise()},getRelModuleLayoutEditor:function o(e){var a=$.Deferred(),d=$.progressIndicator({position:'html',blockInfo:{enabled:!0}}),i={};return i.module=app.getModuleName(),i.parent=app.getParentModuleName(),i.view='Index',i.mode='showRelatedListLayout',i.sourceModule=e,AppConnector.requestPjax(i).done(function(e){d.progressIndicator({mode:'hide'}),a.resolve(e);}).fail(function(){d.progressIndicator({mode:'hide'}),a.reject();}),a.promise()},registerModulesChangeEvent:function d(){var t=this,e=$('#layoutEditorContainer'),a=e.closest('.contentsDiv');App.Fields.Picklist.showSelect2ElementView(e.find('[name="layoutEditorModules"]')),e.on('change','[name="layoutEditorModules"]',function(d){var e=$(d.currentTarget),i=e.val();t.getModuleLayoutEditor(i).done(function(e){a.html(e),t.registerEvents();});});},registerRelModulesChangeEvent:function d(){var t=this,e=$('#layoutEditorContainer'),a=e.closest('.contentsDiv');App.Fields.Picklist.showSelect2ElementView(e.find('[name="layoutEditorRelModules"]')),e.on('change','[name="layoutEditorRelModules"]',function(d){var e=$(d.currentTarget),i=e.val();t.getRelModuleLayoutEditor(i).done(function(e){a.html(e),t.registerEvents();});});},lockCheckbox:function t(e){e.on('change',':checkbox',function(t){var e=$(t.currentTarget);if('readonly'===e.attr('readonly')){var a=$(t.currentTarget).is(':checked');a?$(t.currentTarget).prop('checked',!1):$(t.currentTarget).prop('checked',!0),t.preventDefault();}});},registerEditFieldDetailsClick:function a(e){var t=this;'undefined'==typeof e&&(e=$('#layoutEditorContainer').find('.contents')),e.find('.editFieldDetails').on('click',function(a){var e=$(a.currentTarget),d=e.closest('div.editFields'),i=d.data('fieldId'),o=d.closest('.editFieldsTable'),l=o.data('blockId');app.showModalWindow({url:'index.php?parent=Settings&module=LayoutEditor&view=EditField&fieldId='+d.data('fieldId'),cb:function a(e){t.registerFieldDetailsChange(e),t.lockCheckbox(e),t.registerVaribleToParsers(e),app.registerEventForClockPicker(e.find('.clockPicker'));},sendByAjaxCb:function s(e,a){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate('JS_FIELD_DETAILS_SAVED')});var n=a.result,r=d.find('.fieldLabel');'1'===n.presence&&(d.parent().fadeOut('slow').remove(),$.isEmptyObject(t.inActiveFieldsList[l])?(0===t.inActiveFieldsList.length&&(t.inActiveFieldsList={}),t.inActiveFieldsList[l]={},t.inActiveFieldsList[l][i]=n.label):t.inActiveFieldsList[l][i]=n.label,t.reArrangeBlockFields(o)),n.mandatory?0===r.find('.redColor').length&&d.find('.fieldLabel').append($('<span class="redColor">*</span>')):d.find('.fieldLabel').find('.redColor').remove();}});});},registerVaribleToParsers:function e(t){t.find('.configButton').on('click',function(){t.find('.defaultValueUi .input-group').each(function(t,a){var e=$(a);e.hasClass('d-none')?e.find('input,select').prop('disabled',!1):e.find('input,select').prop('disabled',!0),e.toggleClass('d-none');});}),t.find('.varibleToParsers').on('click',function(a){var e=$(a.currentTarget).closest('.input-group').find('[name="fieldDefaultValue"]'),d=t.find('[name="fieldid"]').val();app.showModalWindow({id:'varibleToParsersModal',url:'index.php?parent=Settings&module=LayoutEditor&view=VaribleToParsers&fieldId='+d+'&defaultValue='+e.val(),cb:function d(t){var a=t.find('select');t.find('[name="saveButton"]').on('click',function(){e.val(a.val()),app.hideModalWindow(null,'varibleToParsersModal');});}});});},registerBlockEvents:function t(){var e=this;e.makeBlocksListSortable(),e.registerAddCustomFieldEvent(),e.registerBlockVisibilityEvent(),e.registerInactiveFieldsEvent(),e.registerDeleteCustomBlockEvent();},registerFieldEvents:function a(e){var t=this;'undefined'==typeof e&&(e=$('#layoutEditorContainer').find('.contents')),App.Fields.Date.register(e),app.registerEventForClockPicker(e),App.Fields.Picklist.changeSelectElementView(e),t.makeFieldsListSortable(),t.registerDeleteCustomFieldEvent(e),t.registerEditFieldDetailsClick(e),e.find(':checkbox').on('change',function(t){var e=$(t.currentTarget);if('readonly'==e.attr('readonly')){var a=$(t.currentTarget).is(':checked');a?$(t.currentTarget).prop('checked',!1):$(t.currentTarget).prop('checked',!0),t.preventDefault();}});},registerSwitch:function a(){var e=$('#layoutEditorContainer'),t=e.find('.inventoryNav');e.find('.js-switch--inventory').on('change',function(t){var a=$(t.currentTarget),d=a.data('value'),i=app.vtranslate('JS_EXTENDED_MODULE');Vtiger_Helper_Js.showConfirmationBox({message:'<span class="message-medium">'+i+'</span>',className:'test'}).done(function(){var t=$.progressIndicator({message:app.vtranslate('JS_SAVE_LOADER_INFO'),position:'html',blockInfo:{enabled:!0}}),a={};a.module=e.find('[name="layoutEditorModules"]').val(),a.status='basic'===d?0:1,app.saveAjax('setInventory',a).done(function(e){e.result&&window.location.reload();});});});},registerAddInventoryField:function a(){var e=this,t=e.getInventoryViewLayout();t.find('.addInventoryField').on('click',function(t){var a=$(t.currentTarget),d=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val(),i=a.closest('.inventoryBlock').data('block-id'),o=$.progressIndicator();app.showModalWindow(null,'index.php?module=LayoutEditor&parent=Settings&view=CreateInventoryFields&mode=step1&type='+d+'&block='+i,function(t){app.showScrollBar(t.find('.well'),{height:'300px'}),e.registerStep1(t,i),o.progressIndicator({mode:'hide'});});});},registerEditInventoryField:function a(){var e=this,t=e.getInventoryViewLayout();t.find('.editInventoryField').on('click',function(t){var a=$(t.currentTarget),d=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val(),i=a.closest('.inventoryBlock').data('block-id'),o=a.closest('.editFields'),l=o.data('name'),n=o.data('id'),r=$.progressIndicator();app.showModalWindow(null,'index.php?module=LayoutEditor&parent=Settings&view=CreateInventoryFields&mode=step2&type='+d+'&mtype='+l+'&id='+n,function(t){app.showPopoverElementView(t.find('.js-help-info')),e.registerStep2(t,i),r.progressIndicator({mode:'hide'});});});},registerStep1:function d(e,t){var a=this;e.find('.nextButton').on('click',function(){var d=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val(),i=e.find('select.type').val();app.hideModalWindow();var o=$.progressIndicator({position:'html',blockInfo:{enabled:!0}});app.showModalWindow(null,'index.php?module=LayoutEditor&parent=Settings&view=CreateInventoryFields&mode=step2&type='+d+'&mtype='+i,function(e){a.registerStep2(e,t),o.progressIndicator({mode:'hide'});});});},registerStep2:function i(e,t){var a=this,d=a.getInventoryViewLayout(),o=e.find('form'),l=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val();o.validationEngine(app.validationEngineOptions),o.on('submit',function(){var e=o.serializeFormData(),n=a.getParamsInventory();if(n){var r={};for(var s in e)if(-1!=$.inArray(s,n)){var i=e[s];'modules'===s&&'string'==typeof i&&(i=[i]),r[s]=i,delete e[s];}e.params=JSON.stringify(r);}var c=o.validationEngine('validate');!1!=c&&(e.block=t,e.module=l,app.saveAjax('saveInventoryField',e).done(function(e){var t=e.result;if(t&&t.edit){app.hideModalWindow();var a=d.find('[data-id="'+t.data.id+'"]');a.find('.fieldLabel').text(t.data.translate);}else if(t){app.hideModalWindow();var i=d.find('.newLiElement').clone(!0,!0);i.removeClass('d-none newLiElement').find('.editFields').attr('data-id',t.data.id).attr('data-sequence',t.data.sequence).attr('data-name',t.data.invtype).attr('data-column',t.data.columnname).find('.fieldLabel').text(t.data.translate),d.find('[data-block-id="'+t.data.block+'"] .connectedSortable').append(i);}}));}),e.find('form').on('submit',function(e){e.preventDefault();});},registerInventoryFieldSequenceSaveClick:function d(){var e=this,t=e.getInventoryViewLayout(),a=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val();t.on('click','.saveFieldSequence',function(t){var e=$(t.currentTarget),d=e.closest('.inventoryBlock'),i={},o=[];d.find('.editFields').each(function(){o.push($(this).data('id'));}),i.module=a,i.ids=o,app.saveAjax('saveSequence',i).done(function(){e.addClass('invisible');});});},registerDeleteInventoryField:function d(){var e=this,t=e.getInventoryViewLayout(),a=$('#layoutEditorContainer').find('[name="layoutEditorModules"]').val();t.find('.deleteInventoryField').on('click',function(t){var e=$(t.currentTarget),d=e.closest('li'),i=app.vtranslate('JS_DELETE_INVENTORY_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:i}).done(function(){var e=$.progressIndicator({message:app.vtranslate('JS_SAVE_LOADER_INFO'),position:'html',blockInfo:{enabled:!0}}),t=d.find('.editFields'),i={};i.id=t.data('id'),i.module=a,i.name=t.data('name'),i.column=t.data('column'),app.saveAjax('delete',i).done(function(){d.remove(),Settings_Vtiger_Index_Js.showMessage({type:'success',text:app.vtranslate('JS_SAVE_CHANGES')}),e.progressIndicator({mode:'hide'});});}).fail(function(){});});},getParamsInventory:function e(){if('undefined'!=typeof app.getMainParams('params'))return JSON.parse(app.getMainParams('params'))},loadMultiReferenceFields:function d(e){var t=this,a=e.find('[name="MRVModule"]').val();e.find('[name="MRVField"],[name="MRVFilterField"]').select2('destroy'),e.find('[name="MRVField"]').html(t.cacheMRVField.html()),e.find('[name="MRVField"] optgroup').each(function(){$(this).data('module')!=a&&$(this).remove();}),e.find('[name="MRVFilterField"]').html(t.cacheMRVFilter.html()),e.find('[name="MRVFilterField"] option').each(function(){$(this).data('module')!=a&&$(this).remove();}),App.Fields.Picklist.showSelect2ElementView(e.find('[name="MRVField"],[name="MRVFilterField"]'),{width:'100%'});},cacheMRVField:!1,cacheMRVFilter:!1,registerMultiReferenceFieldsChangeEvent:function a(e){var t=this;t.cacheMRVField=e.find('[name="MRVField"]').clone(!0,!0),t.cacheMRVFilter=e.find('[name="MRVFilterField"]').clone(!0,!0),e.find('[name="MRVModule"]').on('change',function(){t.loadMultiReferenceFields(e);});},registerMultiReferenceFilterFieldChangeEvent:function t(e){e.find('[name="MRVFilterField"]').on('change',function(){var t={};t.module=app.getModuleName(),t.parent=app.getParentModuleName(),t.action='Field',t.mode='getPicklist',t.rfield=e.find('[name="MRVFilterField"]').val(),t.rmodule=e.find('[name="MRVModule"]').val(),e.find('[name="MRVFilterValue"]').select2('destroy'),e.find('[name="MRVFilterValue"] option').remove(),AppConnector.request(t).done(function(t){$.each(t.result,function(t,a){e.find('[name="MRVFilterValue"]').append($('<option>').val(t).html(a));}),App.Fields.Picklist.showSelect2ElementView(e.find('[name="MRVFilterValue"]'),{width:'100%'});});});},registerCopyClipboard:function t(e){new ClipboardJS('.copyFieldLabel',{text:function a(t){return Vtiger_Helper_Js.showPnotify({text:app.vtranslate('JS_NOTIFY_COPY_TEXT'),type:'success'}),e.find('#'+t.getAttribute('data-target')).val()}});},registerContextHelp:function t(e){e.on('click','.js-context-help',function(t){var e=$.progressIndicator({blockInfo:{enabled:!0}}),a=$(t.currentTarget);AppConnector.request({module:app.getModuleName(),parent:app.getParentModuleName(),view:'HelpInfo',field:a.data('field-id')}).done(function(t){app.showModalWindow(t,function(t){var a={toolbar:'Min',toolbarGroups:[{name:'document',groups:['document','doctools']},{name:'basicstyles',groups:['basicstyles','cleanup']},{name:'clipboard',groups:['clipboard','undo']}]};new App.Fields.Text.Editor(t,a),app.showPopoverElementView(t.find('.js-help-info')),e.progressIndicator({mode:'hide'}),t.find('.js-lang').on('change',function(d){var e=t.find('.js-editor:not([disabled])');App.Fields.Text.destroyEditor(e),e.closest('.js-context-block').addClass('d-none'),e.prop('disabled',!0);var i=$(d.currentTarget).val(),o=t.find('#'+i+'.js-context-area');o.prop('disabled',!1),o.closest('.js-context-block').removeClass('d-none'),t.find('.js-help-info').attr('data-content',o.val()),new App.Fields.Text.Editor(o,a);}),t.find('form').on('submit',function(t){t.preventDefault();var e=$(t.currentTarget),a=e.serializeFormData();'undefined'==typeof a.views&&(a.views=e.find('[name="views"]').val()),app.saveAjax('contextHelp','',a).done(function(){Vtiger_Helper_Js.showPnotify({type:'success',text:app.vtranslate('JS_SAVE_CHANGES')});var t=e.find('.js-lang').val(),a=e.find('#'+t+'.js-context-area');e.find('.js-help-info').attr('data-content',a.val());});});});});});},registerEvents:function a(){var e=this,t=$('#layoutEditorContainer');e.registerBlockEvents(),e.registerFieldEvents(),e.setInactiveFieldsList(),e.registerAddCustomBlockEvent(),e.registerFieldSequenceSaveClick(),e.relatedModulesTabClickEvent(),e.registerModulesChangeEvent(),e.registerRelModulesChangeEvent(),1===$('#relatedTabOrder').length&&(e.registerRelatedListEvents(),e.makeRelatedModuleSortable()),e.registerSwitch(),e.registerAddInventoryField(),e.registerEditInventoryField(),e.registerInventoryFieldSequenceSaveClick(),e.registerDeleteInventoryField(),e.registerCopyClipboard(t),e.registerContextHelp(t);}}),$(document).ready(function(){var e=new Settings_LayoutEditor_Js;e.registerEvents();}),Vtiger_WholeNumberGreaterThanZero_Validator_Js('Vtiger_FloatingDigits_Validator_Js',{invokeValidation:function d(e){var t=new Vtiger_FloatingDigits_Validator_Js;t.setElement(e);var a=t.validate();if(!0!=a)return t.getError()}},{validate:function o(){var e=this._super();if(!0!=e)return e;var t=this.getFieldValue();if(2>t||5<t){var a=app.vtranslate('JS_PLEASE_ENTER_NUMBER_IN_RANGE_2TO5');return this.setError(a),!1}var d=/^[+]/;if(d.test(t)){var i=app.vtranslate('JS_CONTAINS_ILLEGAL_CHARACTERS');return this.setError(i),!1}return !0}}),Vtiger_WholeNumberGreaterThanZero_Validator_Js('Vtiger_DecimalMaxLength_Validator_Js',{invokeValidation:function d(e){var t=new Vtiger_DecimalMaxLength_Validator_Js;t.setElement(e);var a=t.validate();if(!0!=a)return t.getError()}},{validate:function n(){var e=this._super();if(!0!=e)return e;var t=this.getFieldValue(),a=$('#createFieldForm').find('[name="decimal"]').val(),d=parseInt(64)-parseInt(a);if(t>d&&!(0>d)&&59<=d){var i=app.vtranslate('JS_LENGTH_SHOULD_BE_LESS_THAN_EQUAL_TO')+' '+d;return this.setError(i),!1}var o=/^[+]/;if(o.test(t)){var l=app.vtranslate('JS_CONTAINS_ILLEGAL_CHARACTERS');return this.setError(l),!1}return !0}}),Vtiger_WholeNumberGreaterThanZero_Validator_Js('Vtiger_MaxLength_Validator_Js',{invokeValidation:function d(e){var t=new Vtiger_DecimalMaxLength_Validator_Js;t.setElement(e);var a=t.validate();if(!0!=a)return t.getError()}},{validate:function o(){var e=this._super();if(!0!=e)return e;var t=this.getFieldValue();if(255<t){var a=app.vtranslate('JS_LENGTH_SHOULD_BE_LESS_THAN_EQUAL_TO')+' 255';return this.setError(a),!1}var d=/^[+]/;if(d.test(t)){var i=app.vtranslate('JS_CONTAINS_ILLEGAL_CHARACTERS');return this.setError(i),!1}return !0}}),Vtiger_Base_Validator_Js('Vtiger_FieldLabel_Validator_Js',{invokeValidation:function d(e){var t=new Vtiger_FieldLabel_Validator_Js;t.setElement(e);var a=t.validate();if(!0!=a)return t.getError()}},{validate:function t(){var e=this.getFieldValue();return this.validateValue(e)},validateValue:function d(e){var t=/[&\<\>\:\'\"\,]/;if(t.test(e)){var a=app.vtranslate('JS_SPECIAL_CHARACTERS')+' & < > \' " : , '+app.vtranslate('JS_NOT_ALLOWED');return this.setError(a),!1}return !0}}),Vtiger_Base_Validator_Js('Vtiger_PicklistFieldValues_Validator_Js',{invokeValidation:function d(e){var t=new Vtiger_PicklistFieldValues_Validator_Js;t.setElement(e);var a=t.validate();if(!0!=a)return t.getError()}},{validate:function e(){return this.validateValue(this.getElement().val())},validateValue:function i(e){var t=this,a=/[\<\>\"\,\#]/,d=!0;return $.each(e,function(e,i){a.test(i)&&(t.setError(app.vtranslate('JS_SPECIAL_CHARACTERS')+' < > " , # '+app.vtranslate('JS_NOT_ALLOWED')),d=!1);}),d}});
//# sourceMappingURL=LayoutEditor.min.js.map
