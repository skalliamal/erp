{"version":3,"file":"ModuleImport.min.js","sources":["ModuleImport.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class('Settings_Module_Import_Js', {}, {\n\t/**\n\t * Function to get import module step1 params\n\t */\n\tgetImportModuleStep1Params: function () {\n\t\tvar params = {\n\t\t\t'module': app.getModuleName(),\n\t\t\t'parent': app.getParentModuleName(),\n\t\t\t'view': 'ModuleImport'\n\t\t}\n\t\treturn params;\n\t},\n\n\t/**\n\t * Function to get import module with respect to view\n\t */\n\tgetImportModuleStepView: function (params) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\taDeferred.reject(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t/**\n\t * Function to register event for step1 of import module\n\t */\n\tregisterEventForStep1: function () {\n\t\tvar detailContentsHolder = jQuery('.contentsDiv');\n\t\tapp.showScrollBar(jQuery('.extensionDescription'), {'height': '120px', 'width': '100%', 'railVisible': true});\n\t\tthis.registerEventsForImportModuleStep1(detailContentsHolder);\n\t},\n\n\t/**\n\t * Function to register event related to Import extrension Modules in step1\n\t */\n\tregisterEventsForImportModuleStep1: function (container) {\n\t\tvar thisInstance = this;\n\t\tjQuery(container).find('.installExtension').on('click', function (e) {\n\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\tvar extensionContainer = element.closest('.extension_container');\n\t\t\tvar extensionId = extensionContainer.find('[name=\"extensionId\"]').val();\n\t\t\tvar moduleAction = extensionContainer.find('[name=\"moduleAction\"]').val();\n\t\t\tvar extensionName = extensionContainer.find('[name=\"extensionName\"]').val();\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'parent': app.getParentModuleName(),\n\t\t\t\t'view': 'ModuleImport',\n\t\t\t\t'mode': 'step2',\n\t\t\t\t'extensionId': extensionId,\n\t\t\t\t'moduleAction': moduleAction,\n\t\t\t\t'extensionName': extensionName\n\t\t\t}\n\n\t\t\tthisInstance.getImportModuleStepView(params).done(function (data) {\n\t\t\t\tvar detailContentsHolder = jQuery('.contentsDiv');\n\t\t\t\tdetailContentsHolder.html(data);\n\t\t\t\tapp.showScrollBar(jQuery('#extensionLicense'), {'height': 'auto'});\n\t\t\t\tthisInstance.registerEventsForImportModuleStep2(detailContentsHolder);\n\t\t\t});\n\t\t})\n\t},\n\n\t/**\n\t * Function to register event related to Import extrension Modules in step2\n\t */\n\tregisterEventsForImportModuleStep2: function (container) {\n\t\tcontainer = jQuery(container);\n\t\tvar thisInstance = this;\n\n\t\tcontainer.find('#installExtension').on('click', function () {\n\t\t\tvar extensionId = jQuery('[name=\"extensionId\"]').val();\n\t\t\tvar targetModule = jQuery('[name=\"targetModule\"]').val();\n\t\t\tvar moduleType = jQuery('[name=\"moduleType\"]').val();\n\t\t\tvar moduleAction = jQuery('[name=\"moduleAction\"]').val();\n\t\t\tvar fileName = jQuery('[name=\"fileName\"]').val();\n\n\t\t\tvar params = {\n\t\t\t\t'module': app.getModuleName(),\n\t\t\t\t'parent': app.getParentModuleName(),\n\t\t\t\t'view': 'ModuleImport',\n\t\t\t\t'mode': 'step3',\n\t\t\t\t'extensionId': extensionId,\n\t\t\t\t'moduleAction': moduleAction,\n\t\t\t\t'targetModule': targetModule,\n\t\t\t\t'moduleType': moduleType,\n\t\t\t\t'fileName': fileName\n\t\t\t}\n\n\t\t\tthisInstance.getImportModuleStepView(params).done(function (step3Data) {\n\t\t\t\tvar callBackFunction = function (data) {\n\t\t\t\t\tvar installationStatus = jQuery(data).find('[name=\"installationStatus\"]').val();\n\t\t\t\t\tif (installationStatus == \"success\") {\n\t\t\t\t\t\tjQuery('#installExtension').remove();\n\t\t\t\t\t}\n\t\t\t\t\tapp.showScrollBar(jQuery('#installationLog'), {'height': '150px'});\n\t\t\t\t\tjQuery(data).find('#importCompleted').on('click', function (e) {\n\t\t\t\t\t\tcontainer.find('#declineExtension').trigger('click');\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tvar modalData = {\n\t\t\t\t\tdata: step3Data,\n\t\t\t\t\tunblockcb: function () {\n\t\t\t\t\t\tcontainer.find('#declineExtension').trigger('click');\n\t\t\t\t\t},\n\t\t\t\t\tcss: {'width': '60%', 'height': '40%'},\n\t\t\t\t\tcb: callBackFunction\n\t\t\t\t};\n\t\t\t\tapp.showModalWindow(modalData);\n\t\t\t});\n\t\t})\n\n\t\tcontainer.find('#declineExtension').on('click', function () {\n\t\t\tvar params = thisInstance.getImportModuleStep1Params();\n\t\t\tthisInstance.getImportModuleStepView(params).done(function (data) {\n\t\t\t\tvar detailContentsHolder = jQuery('.contentsDiv');\n\t\t\t\tdetailContentsHolder.html(data);\n\t\t\t\tthisInstance.registerEventForStep1();\n\t\t\t});\n\t\t})\n\t},\n\n\tregisterEvents: function () {\n\t\tthis.registerEventForStep1();\n\t}\n});\n\n\njQuery(document).ready(function () {\n\tvar settingModuleImportInstance = new Settings_Module_Import_Js();\n\tsettingModuleImportInstance.registerEvents();\n})\n\n\n\n"],"names":["jQuery","Class","getImportModuleStep1Params","app","getModuleName","getParentModuleName","getImportModuleStepView","params","Deferred","progressIndicatorElement","progressIndicator","request","done","data","aDeferred","resolve","fail","error","reject","promise","registerEventForStep1","showScrollBar","registerEventsForImportModuleStep1","detailContentsHolder","container","find","on","e","currentTarget","extensionContainer","element","closest","extensionId","val","moduleAction","extensionName","thisInstance","html","registerEventsForImportModuleStep2","targetModule","moduleType","fileName","step3Data","showModalWindow","unblockcb","trigger","css","cb","remove","registerEvents","document","ready","settingModuleImportInstance"],"mappings":"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"}