{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class(\"Settings_CurrencyUpdate_Index_Js\", {}, {\n\t/*\n\t * Shows or hides block informing about supported currencies by presently chosen bank\n\t */\n\tregisterInfoButton: function (container) {\n\t\tcontainer.find('#supportedCurrencies').on('click', function () {\n\t\t\tjQuery('#infoBlock').toggleClass('d-none');\n\t\t});\n\t},\n\t/*\n\t * Shows or hides block informing about unsupported currencies by presently chosen bank\n\t */\n\tregisterAlertButton: function (container) {\n\t\tcontainer.find('#unsupportedCurrencies').on('click', function () {\n\t\t\tcontainer.find('#alertBlock').toggleClass('d-none');\n\t\t});\n\t},\n\t/*\n\t * Event fired on bank picklist change.\n\t * Daves the chosen bank as active in database.\n\t * Updates information about supported and unsupported currencies for currently chosen bank,\n\t */\n\tregisterBankChange: function (container) {\n\t\tcontainer.find('#bank').on('change', function () {\n\t\t\tlet bankName = container.find('#bank option:selected').data('name');\n\t\t\tcontainer.find('#alertSpan').html('');\n\t\t\tcontainer.find('#infoSpan').html('');\n\t\t\tvar infoProgress = jQuery.progressIndicator({\n\t\t\t\tposition: 'html',\n\t\t\t\tblockInfo: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t});\n\t\t\tvar params = {};\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'GetBankCurrencies',\n\t\t\t\tmode: 'supported',\n\t\t\t\tname: bankName\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tvar response = data['result'];\n\t\t\t\tvar html = '';\n\t\t\t\tfor (var name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#infoSpan').html(html);\n\t\t\t});\n\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'GetBankCurrencies',\n\t\t\t\tmode: 'unsupported',\n\t\t\t\tname: bankName\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tvar response = data['result'];\n\t\t\t\tif (jQuery.isEmptyObject(response)) {\n\t\t\t\t\tif (!container.find('#unsupportedCurrencies').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#unsupportedCurrencies').addClass('d-none');\n\t\t\t\t\t}\n\t\t\t\t\tif (!container.find('#alertBlock').hasClass('d-none')) {\n\t\t\t\t\t\tcontainer.find('#alertBlock').addClass('d-none')\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.find('#unsupportedCurrencies').removeClass('d-none');\n\t\t\t\t}\n\t\t\t\tvar html = '';\n\t\t\t\tfor (var name in response) {\n\t\t\t\t\thtml += '<p><strong>' + name + '</strong> - ' + response[name] + '</p>';\n\t\t\t\t}\n\t\t\t\tcontainer.find('#alertSpan').html(html);\n\t\t\t});\n\n\t\t\tvar bankId = jQuery('#bank option:selected').val();\n\t\t\tparams.data = {\n\t\t\t\tparent: app.getParentModuleName(),\n\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\taction: 'SaveActiveBank',\n\t\t\t\tid: bankId\n\t\t\t};\n\t\t\tparams.dataType = 'json';\n\t\t\tAppConnector.request(params).done(function (data) {\n\t\t\t\tvar response = data['result'];\n\t\t\t\tif (response['success']) {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\ttype: 'success'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t} else {\n\t\t\t\t\tvar params = {\n\t\t\t\t\t\ttext: response['message'],\n\t\t\t\t\t\thide: false,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t};\n\t\t\t\t\tVtiger_Helper_Js.showPnotify(params);\n\t\t\t\t}\n\t\t\t\tinfoProgress.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register events\n\t */\n\tregisterEvents: function () {\n\t\tvar container = jQuery('#currencyUpdateContainer');\n\t\tApp.Fields.Date.register('#datepicker', false, {});\n\t\tthis.registerInfoButton(container);\n\t\tthis.registerAlertButton(container);\n\t\tthis.registerBankChange(container);\n\t}\n});\n"],"names":["jQuery","Class","registerInfoButton","container","find","on","toggleClass","registerAlertButton","registerBankChange","data","html","progressIndicator","position","blockInfo","enabled","params","parent","app","getParentModuleName","module","getModuleName","action","mode","name","bankName","dataType","AppConnector","request","done","response","isEmptyObject","hasClass","addClass","removeClass","val","id","bankId","text","type","Vtiger_Helper_Js","showPnotify","hide","infoProgress","registerEvents","App","Fields","Date","register"],"mappings":"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"}