'use strict';

jQuery.Class('Settings_PublicHoliday_Js',{},{registerDeleteHoliday:function c(a){var b=this;a.find('.deleteHoliday').each(function(){jQuery(this).on('click',function(){b.deleteHoliday(jQuery(this).data('holiday-id'));});});},deleteHoliday:function e(a){var b=this,c=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),d={};d.module=app.getModuleName(),d.parent=app.getParentModuleName(),d.action='Holiday',d.mode='delete',d.id=a,AppConnector.request(d).done(function(a){var d={};d.module=app.getModuleName(),d.view='Configuration',d.parent=app.getParentModuleName(),d.async=!1,AppConnector.request(d).done(function(a){jQuery('.contentsDiv').html(a),b.registerEvents(),c.progressIndicator({mode:'hide'});}),d={},d.text=a.result.message,Settings_Vtiger_Index_Js.showMessage(d);}).fail(function(){c.progressIndicator({mode:'hide'});});},registerAddDate:function c(){var a=this,b=jQuery('#layoutDashBoards');b.find('.addDateWindow').on('click',function(){var c=b.find('.addDateWindowModal').clone(!0,!0),d=app.vtranslate('JS_ADD_NEW_HOLIDAY');c.find('.modal-title').text(d);var e=function(b){b.find('.addDateWindowModal').removeClass('d-none').show();var c=b.find('.addDateWindowForm');jQuery('[name="holidayId"]').val(''),jQuery(document).find('div.blockOverlay').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),c.on('submit',function(b){b.preventDefault();var d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return a.saveNewDate(c).done(function(b){var c={};if(b.success){var e=b.result;c.text=e.message,Settings_Vtiger_Index_Js.showMessage(c);var c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(b){jQuery('.contentsDiv').html(b),a.registerEvents(),d.progressIndicator({mode:'hide'});});}else d.progressIndicator({mode:'hide'}),c.text=b.result.message,c.type='error',Settings_Vtiger_Index_Js.showMessage(c);}),app.hideModalWindow(),!0});};app.showModalWindow(c,function(a){'function'==typeof e&&e(a);},{width:'1000px'});});},registerEditDate:function c(){var a=this,b=jQuery('#layoutDashBoards');b.find('.editHoliday').on('click',function(){var c=b.find('.addDateWindowModal').clone(!0,!0),d=jQuery(this).closest('.holidayElement');c.find('[name="holidayId"]').val(d.data('holiday-id')),c.find('[name="holidayDate"]').val(d.data('holiday-date')),c.find('[name="holidayName"]').val(d.data('holiday-name')),c.find('[name="holidayType"]').val(d.data('holiday-type'));var e=app.vtranslate('JS_EDIT_HOLIDAY');c.find('.modal-title').text(e);var f=function(b){b.find('.addDateWindowModal').removeClass('d-none').show();var c=b.find('.addDateWindowForm');jQuery('[name="saveButton"]').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});return a.saveNewDate(c).done(function(c){var d={};if(c.success){var e=c.result;d.text=e.message,Settings_Vtiger_Index_Js.showMessage(d);var d={};d.module=app.getModuleName(),d.view='Configuration',d.parent=app.getParentModuleName(),AppConnector.request(d).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}else b.progressIndicator({mode:'hide'}),d.text=c.result.message,d.type='error',Settings_Vtiger_Index_Js.showMessage(d);}),app.hideModalWindow(),!0}),jQuery(document).find('div.blockOverlay').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),jQuery('.cancelLink').on('click',function(){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(c){jQuery('.contentsDiv').html(c),a.registerEvents(),b.progressIndicator({mode:'hide'});});}),c.on('submit',function(a){a.preventDefault();});};app.showModalWindow(c,function(a){'function'==typeof f&&f(a);},{width:'1000px'});});},saveNewDate:function f(a){var b=this,c=a.serializeFormData();if(c.module=app.getModuleName(),c.parent=app.getParentModuleName(),c.action='Holiday',c.mode='save',''==c.holidayName||''==c.holidayDate){var c=[];c.text=app.vtranslate('JS_FILL_FORM_ERROR'),c.type='error',Settings_Vtiger_Index_Js.showMessage(c);var d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c={};c.module=app.getModuleName(),c.view='Configuration',c.parent=app.getParentModuleName(),AppConnector.request(c).done(function(a){jQuery('.contentsDiv').html(a),b.registerEvents(),d.progressIndicator({mode:'hide'});});}else{var e=jQuery.Deferred();return AppConnector.request(c).done(function(a){e.resolve(a);}).fail(function(a){e.reject(a);}),e.promise()}return !0},registerChangeDate:function c(){var a=this,b=jQuery('.dateFilter');App.Fields.Date.registerRange(b,{ranges:!1}),b.on('apply.daterangepicker',function(b,c){var d=jQuery(b.currentTarget).data('dateFormat').toUpperCase();$(this).val(c.startDate.format(d)+','+c.endDate.format(d));var e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:app.getModuleName(),view:'Configuration',parent:app.getParentModuleName(),date:'["'+c.startDate.format(d)+'","'+c.endDate.format(d)+'"]'}).done(function(b){jQuery('.contentsDiv').html(b),a.registerEvents(),e.progressIndicator({mode:'hide'});});});},registerEvents:function c(){var a=this,b=jQuery('#moduleBlocks');a.registerDeleteHoliday(b),a.registerAddDate(),a.registerEditDate(),a.registerChangeDate();}}),jQuery(document).ready(function(){var a=new Settings_PublicHoliday_Js;a.registerEvents();});
//# sourceMappingURL=PublicHoliday.min.js.map
