{"version":3,"file":"Edit.min.js","sources":["Edit.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\njQuery.Class('Settings_AutomaticAssignment_Edit_Js', {}, {\n\tcontainer: false,\n\tadvanceFilterInstance: false,\n\tgetContainer: function () {\n\t\tif (this.container == false) {\n\t\t\tthis.container = jQuery('div.contentsDiv');\n\t\t}\n\t\treturn this.container;\n\t},\n\tregisterBasicEvents: function (container) {\n\t\tvar thisInstance = this;\n\n\t\tvar advanceFilterContainer = container.find('.filterContainer');\n\t\tif (advanceFilterContainer.length) {\n\t\t\tthis.advanceFilterInstance = Vtiger_AdvanceFilter_Js.getInstance(advanceFilterContainer);\n\t\t}\n\t\tvar form = container.find('form');\n\t\tif (form.length) {\n\t\t\tform.validationEngine(app.validationEngineOptions);\n\t\t\tform.find(\"[data-inputmask]\").inputmask();\n\t\t}\n\t\tcontainer.find('.select2noactive').each(function (index, domElement) {\n\t\t\tvar select = $(domElement);\n\t\t\tif (!select.data('select2')) {\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(select, {placeholder: app.vtranslate('JS_SELECT_AN_OPTION')});\n\t\t\t}\n\t\t});\n\t\tvar table = app.registerDataTables(container.find('.dataTable'));\n\t\tif (table) {\n\t\t\ttable.$('.changeRoleType').on('click', function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\tapp.saveAjax('changeRoleType', dataElement.data('value'), {'record': app.getMainParams('record')}).done(function (data) {\n\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t});\n\t\t\t});\n\t\t\ttable.$('.delete').on('click', function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\tvar element = jQuery(e.currentTarget);\n\t\t\t\tvar dataElement = element.closest('tr');\n\t\t\t\tvar params = {\n\t\t\t\t\trecord: app.getMainParams('record'),\n\t\t\t\t\tvalue: dataElement.data('value'),\n\t\t\t\t\tname: dataElement.data('name')\n\t\t\t\t};\n\t\t\t\tapp.saveAjax('deleteElement', null, params).done(function (data) {\n\t\t\t\t\tthisInstance.refreshTab();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tcontainer.find('.fieldContainer').on('click', function (e) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tcontainer.find('.saveValue').on('click', function (e) {\n\t\t\tvar button = jQuery(e.currentTarget);\n\t\t\tvar fieldContainer = button.closest('.fieldContainer');\n\t\t\tvar baseFieldName = fieldContainer.data('dbname');\n\t\t\tif (baseFieldName === 'conditions') {\n\t\t\t\tvar advfilterlist = thisInstance.advanceFilterInstance.getValues();\n\t\t\t\tvar value = JSON.stringify(advfilterlist);\n\t\t\t} else {\n\t\t\t\tvar fieldName = fieldContainer.data('name');\n\t\t\t\tvar fieldElement = fieldContainer.find('[name=\"' + fieldName + '\"]');\n\t\t\t\tif (fieldElement.validationEngine('validate')) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar value = fieldElement.val();\n\t\t\t}\n\n\t\t\tvar params = [];\n\t\t\tparams[baseFieldName] = value;\n\t\t\tapp.saveAjax('save', jQuery.extend({}, params), {'record': app.getMainParams('record')}).done(function (respons) {\n\t\t\t\tthisInstance.refreshTab();\n\t\t\t});\n\t\t});\n\t\tcontainer.find('.js-switch').on('change', (e) => {\n\t\t\tconst currentTarget = $(e.currentTarget),\n\t\t\t\tstate = currentTarget.val();\n\t\t\tlet params = [];\n\t\t\tif (currentTarget.hasClass('noField')) {\n\t\t\t\tif (state === '1') {\n\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').removeClass('d-none');\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (state === '0') {\n\t\t\t\t\tcurrentTarget.closest('form').find('.fieldToShowHide').addClass('d-none');\n\t\t\t\t}\n\t\t\t}\n\t\t\tparams[currentTarget.attr('name')] = Number(state)\n\t\t\tapp.saveAjax('save', jQuery.extend({}, params), {'record': app.getMainParams('record')}).done(function (respons) {\n\t\t\t\tthisInstance.refreshTab();\n\t\t\t});\n\t\t});\n\t},\n\trefreshTab: function () {\n\t\tvar thisInstance = this;\n\t\tSettings_Vtiger_Index_Js.showMessage({text: app.vtranslate('JS_SAVE_SUCCESS')});\n\t\tvar tabContainer = this.getContainer().find('.tab-pane.active');\n\t\tif (tabContainer.hasClass('noRefresh')) {\n\t\t\treturn false;\n\t\t}\n\t\tAppConnector.request(tabContainer.data('url')).done(function (data) {\n\t\t\ttabContainer.html(data);\n\t\t\tthisInstance.registerBasicEvents(tabContainer);\n\t\t}).fail(function (textStatus, errorThrown) {\n\t\t\tapp.errorLog(textStatus, errorThrown);\n\t\t});\n\t},\n\tregisterEvents: function () {\n\t\tthis.registerBasicEvents(this.getContainer());\n\t}\n})\n"],"names":["jQuery","Class","container","advanceFilterInstance","getContainer","registerBasicEvents","advanceFilterContainer","find","length","Vtiger_AdvanceFilter_Js","getInstance","form","validationEngine","app","validationEngineOptions","inputmask","each","index","domElement","$","select","data","App","Fields","Picklist","showSelect2ElementView","placeholder","vtranslate","registerDataTables","table","on","e","stopPropagation","preventDefault","currentTarget","dataElement","element","closest","saveAjax","getMainParams","done","thisInstance","refreshTab","params","record","value","name","fieldContainer","button","baseFieldName","getValues","JSON","stringify","advfilterlist","fieldElement","fieldName","val","extend","state","hasClass","removeClass","addClass","attr","Number","Settings_Vtiger_Index_Js","showMessage","text","tabContainer","request","html","fail","textStatus","errorThrown","errorLog","registerEvents"],"mappings":"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"}