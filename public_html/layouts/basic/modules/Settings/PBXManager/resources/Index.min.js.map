{"version":3,"file":"Index.min.js","sources":["Index.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\nSettings_Vtiger_Index_Js(\"Settings_PBXManager_Index_Js\", {}, {\n\n\t/*\n\t * function to Save the PBXManager Server Details\n\t */\n\tsaveAsteriskServerDetails: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar data = form.serializeFormData();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\n\t\tif (data === \"undefined\") {\n\t\t\tdata = {};\n\t\t}\n\t\tdata.module = app.getModuleName();\n\t\tdata.parent = app.getParentModuleName();\n\t\tdata.action = 'SaveAjax';\n\n\t\tAppConnector.request(data).done(function (data) {\n\t\t\tif (data['success']) {\n\t\t\t\tvar OutgoingServerDetailUrl = form.data('detailUrl');\n\t\t\t\t//after save, load detail view contents and register events\n\t\t\t\tthisInstance.loadContents(OutgoingServerDetailUrl).done(function (data) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tjQuery('.errorMessage', form).removeClass('d-none');\n\t\t\t}\n\t\t});\n\t},\n\n\t/*\n\t * function to register the events in editView\n\t */\n\tregisterEditViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#MyModal');\n\t\tvar cancelLink = jQuery('.cancelLink', form);\n\n\t\t//To Auto-Generate Vtiger Secret Key\n\t\tvar url = 'index.php?module=PBXManager&parent=Settings&action=Gateway&mode=getSecretKey';\n\t\tAppConnector.request(url).done(function (data) {\n\t\t\tjQuery(\"input[name='vtigersecretkey']\").attr(\"value\", data.result);\n\t\t});\n\t\t//END\n\n\t\t//register validation engine\n\t\tvar params = app.validationEngineOptions;\n\t\tparams.onValidationComplete = function (form, valid) {\n\t\t\tif (valid) {\n\t\t\t\tthisInstance.saveAsteriskServerDetails(form);\n\t\t\t\treturn valid;\n\t\t\t}\n\t\t}\n\t\tform.validationEngine(params);\n\t\t//END\n\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t});\n\n\t\t//register click event for cancelLink\n\t\tcancelLink.on('click', function (e) {\n\t\t\tvar OutgoingServerDetailUrl = form.data('detailUrl');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthisInstance.loadContents(OutgoingServerDetailUrl).done(function (data) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t//after loading contents, register the events\n\t\t\t\tthisInstance.registerDetailViewEvents();\n\t\t\t}).fail(function (error, err) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t\t//END\n\t},\n\n\t/*\n\t * function to register the events in DetailView\n\t */\n\tregisterDetailViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\t//Detail view container\n\t\tvar container = jQuery('#AsteriskServerDetails');\n\t\tvar editButton = jQuery('.editButton', container);\n\n\t\teditButton.on('click', function (e) {\n\t\t\tvar url = jQuery(e.currentTarget).data('url');\n\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t'position': 'html',\n\t\t\t\t'blockInfo': {\n\t\t\t\t\t'enabled': true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthisInstance.loadContents(url).done(function (data) {\n\t\t\t\t//after load the contents register the edit view events\n\t\t\t\tthisInstance.registerEditViewEvents();\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t}).fail(function (error, err) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t});\n\t\t});\n\t},\n\n\t/*\n\t * function to load the contents from the url through pjax\n\t */\n\tloadContents: function (url) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tAppConnector.requestPjax(url).done(function (data) {\n\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\taDeferred.reject();\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\n\t// to Registering  required Events on list view page load\n\tregisterEvents: function () {\n\t\tvar thisInstance = this;\n\t\tthisInstance.registerDetailViewEvents();\n\t}\n});\n\njQuery(document).ready(function (e) {\n\tvar instance = new Settings_Vtiger_Index_Js();\n\tinstance.registerEvents();\n});\n\n"],"names":["Settings_Vtiger_Index_Js","saveAsteriskServerDetails","form","data","serializeFormData","progressIndicatorElement","jQuery","progressIndicator","module","app","getModuleName","parent","getParentModuleName","action","AppConnector","request","done","thisInstance","loadContents","OutgoingServerDetailUrl","registerDetailViewEvents","fail","removeClass","registerEditViewEvents","cancelLink","attr","result","validationEngineOptions","params","onValidationComplete","valid","validationEngine","on","e","preventDefault","container","editButton","currentTarget","url","Deferred","requestPjax","html","aDeferred","resolve","reject","promise","registerEvents","document","ready","instance"],"mappings":"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"}