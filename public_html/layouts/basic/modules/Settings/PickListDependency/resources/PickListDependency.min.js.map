{"version":3,"file":"PickListDependency.min.js","sources":["PickListDependency.js"],"sourcesContent":["/*+***********************************************************************************\n * The contents of this file are subject to the vtiger CRM Public License Version 1.0\n * (\"License\"); You may not use this file except in compliance with the License\n * The Original Code is:  vtiger CRM Open Source\n * The Initial Developer of the Original Code is vtiger.\n * Portions created by vtiger are Copyright (C) vtiger.\n * All Rights Reserved.\n *************************************************************************************/\n'use strict';\n\njQuery.Class('Settings_PickListDependency_Js', {\n\t//holds the picklist dependency instance\n\tpickListDependencyInstance: false,\n\t/**\n\t * Function used to triggerAdd new Dependency for the picklists\n\t */\n\ttriggerAdd: function (event) {\n\t\tevent.stopPropagation();\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\tinstance.updatedSourceValues = [];\n\t\tinstance.showEditView(instance.listViewForModule).done(function (data) {\n\t\t\tinstance.registerAddViewEvents();\n\t\t});\n\t},\n\t/**\n\t * This function used to trigger Edit picklist dependency\n\t */\n\ttriggerEdit: function (event, module, sourceField, targetField) {\n\t\tevent.stopPropagation();\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\t\tinstance.updatedSourceValues = [];\n\t\tinstance.showEditView(module, sourceField, targetField).done(\n\t\t\tfunction (data) {\n\t\t\t\tvar form = jQuery('#pickListDependencyForm');\n\t\t\t\tform.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]').prop(\"disabled\", true);\n\t\t\t\tvar element = form.find('.dependencyMapping');\n\t\t\t\tinstance.registerDependencyGraphEvents();\n\t\t\t\tinstance.registerSubmitEvent();\n\t\t\t}\n\t\t);\n\t},\n\t/**\n\t * This function used to trigger Delete picklist dependency\n\t */\n\ttriggerDelete: function (event, module, sourceField, targetField) {\n\t\tevent.stopPropagation();\n\t\tvar currentTarget = jQuery(event.currentTarget);\n\t\tvar currentTrEle = currentTarget.closest('tr');\n\t\tvar instance = Settings_PickListDependency_Js.pickListDependencyInstance;\n\n\t\tvar message = app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_DELETE');\n\t\tVtiger_Helper_Js.showConfirmationBox({'message': message}).done(function (e) {\n\t\t\tinstance.deleteDependency(module, sourceField, targetField).done(function (data) {\n\t\t\t\tvar params = {};\n\t\t\t\tparams.text = app.vtranslate('JS_DEPENDENCY_DELETED_SUEESSFULLY');\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\tcurrentTrEle.fadeOut('slow').remove();\n\t\t\t});\n\t\t});\n\t}\n\n}, {\n\t//constructor\n\tinit: function () {\n\t\tSettings_PickListDependency_Js.pickListDependencyInstance = this;\n\t},\n\t//holds the listview forModule\n\tlistViewForModule: '',\n\t//holds the updated sourceValues while editing dependency\n\tupdatedSourceValues: [],\n\t//holds the new mapping of source values and target values\n\tvalueMapping: [],\n\t//holds the list of selected source values for dependency\n\tselectedSourceValues: [],\n\t/*\n\t * function to show editView for Add/Edit Dependency\n\t * @params: module - selected module\n\t *\t\t\tsourceField - source picklist\n\t *\t\t\ttargetField - target picklist\n\t */\n\tshowEditView: function (module, sourceField, targetField) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'Edit';\n\t\tparams['sourceModule'] = module;\n\t\tparams['sourcefield'] = sourceField;\n\t\tparams['targetfield'] = targetField;\n\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\tvar container = jQuery('.contentsDiv');\n\t\t\tcontainer.html(data);\n\t\t\t//register all select2 Elements\n\t\t\tApp.Fields.Picklist.showSelect2ElementView(container.find('select.select2'), {dropdownCss: {'z-index': 0}});\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\taDeferred.reject(error);\n\t\t});\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function to get the Dependency graph based on selected module\n\t */\n\tgetModuleDependencyGraph: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.find('[name=\"sourceModule\"]').on('change', function () {\n\t\t\tvar forModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\tthisInstance.showEditView(forModule).done(function (data) {\n\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Register change event for picklist fields in add/edit picklist dependency\n\t */\n\tregisterPicklistFieldsChangeEvent: function (form) {\n\t\tvar thisInstance = this;\n\t\tform.find('[name=\"sourceField\"],[name=\"targetField\"]').on('change', function () {\n\t\t\tthisInstance.checkValuesForDependencyGraph(form);\n\t\t});\n\t},\n\t/**\n\t * Function used to check the selected picklist fields are valid before showing dependency graph\n\t */\n\tcheckValuesForDependencyGraph: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar sourceField = form.find('[name=\"sourceField\"]');\n\t\tvar targetField = form.find('[name=\"targetField\"]');\n\t\tvar select2SourceField = app.getSelect2ElementFromSelect(sourceField);\n\t\tvar select2TargetField = app.getSelect2ElementFromSelect(targetField);\n\t\tvar sourceFieldValue = sourceField.val();\n\t\tvar targetFieldValue = targetField.val();\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tif (sourceFieldValue != '' && targetFieldValue != '') {\n\t\t\tvar resultMessage = app.vtranslate('JS_SOURCE_AND_TARGET_FIELDS_SHOULD_NOT_BE_SAME');\n\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\tif (sourceFieldValue == targetFieldValue) {\n\t\t\t\tselect2TargetField.validationEngine('showPrompt', resultMessage, 'error', 'topLeft', true);\n\t\t\t\tdependencyGraph.html('');\n\t\t\t} else {\n\t\t\t\tselect2SourceField.validationEngine('hide');\n\t\t\t\tselect2TargetField.validationEngine('hide');\n\t\t\t\tvar sourceModule = form.find('[name=\"sourceModule\"]').val();\n\t\t\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t\t\t'position': 'html',\n\t\t\t\t\t'blockInfo': {\n\t\t\t\t\t\t'enabled': true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthisInstance.checkCyclicDependency(sourceModule, sourceFieldValue, targetFieldValue).done(function (data) {\n\t\t\t\t\tvar result = data['result'];\n\t\t\t\t\tif (!result['result']) {\n\t\t\t\t\t\tthisInstance.addNewDependencyPickList(sourceModule, sourceFieldValue, targetFieldValue);\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t\t\tform.find('.errorMessage').removeClass('d-none');\n\t\t\t\t\t\tform.find('.cancelAddView').removeClass('d-none');\n\t\t\t\t\t\tdependencyGraph.html('');\n\t\t\t\t\t}\n\t\t\t\t}).fail(function (error, err) {\n\t\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tform.find('.errorMessage').addClass('d-none');\n\t\t\tvar result = app.vtranslate('JS_SELECT_SOME_VALUE');\n\t\t\tif (sourceFieldValue == '') {\n\t\t\t\tselect2SourceField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t} else if (targetFieldValue == '') {\n\t\t\t\tselect2TargetField.validationEngine('showPrompt', result, 'error', 'topLeft', true);\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * Function used to check the cyclic dependency of the selected picklist fields\n\t * @params: sourceModule - selected module\n\t *            sourceFieldValue - source picklist value\n\t *            targetFieldValue - target picklist value\n\t */\n\tcheckCyclicDependency: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar params = {};\n\t\tparams['mode'] = 'checkCyclicDependency';\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'Index';\n\t\tparams['sourceModule'] = sourceModule;\n\t\tparams['sourcefield'] = sourceFieldValue;\n\t\tparams['targetfield'] = targetFieldValue;\n\n\t\tAppConnector.request(params).done(\n\t\t\tfunction (data) {\n\t\t\t\taDeferred.resolve(data);\n\t\t\t}, function (error, err) {\n\t\t\t\taDeferred.reject();\n\t\t\t}\n\t\t);\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function used to show the new picklist dependency graph\n\t * @params: sourceModule - selected module\n\t *            sourceFieldValue - source picklist value\n\t *            targetFieldValue - target picklist value\n\t */\n\taddNewDependencyPickList: function (sourceModule, sourceFieldValue, targetFieldValue) {\n\t\tvar thisInstance = this;\n\t\tvar dependencyGraph = $('#dependencyGraph');\n\t\tthisInstance.updatedSourceValues = [];\n\t\tAppConnector.request({\n\t\t\tmode: 'getDependencyGraph',\n\t\t\tmodule: app.getModuleName(),\n\t\t\tparent: app.getParentModuleName(),\n\t\t\tview: 'IndexAjax',\n\t\t\tsourceModule: sourceModule,\n\t\t\tsourcefield: sourceFieldValue,\n\t\t\ttargetfield: targetFieldValue\n\t\t}).done(function (data) {\n\t\t\tdependencyGraph.html(data).css({'padding': '10px', 'border': '1px solid #ddd', 'background': '#fff'});\n\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t});\n\t},\n\t/**\n\t * This function will delete the pickList Dependency\n\t * @params: module - selected module\n\t *            sourceField - source picklist value\n\t *            targetField - target picklist value\n\t */\n\tdeleteDependency: function (module, sourceField, targetField) {\n\t\tvar aDeferred = jQuery.Deferred();\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['action'] = 'DeleteAjax';\n\t\tparams['sourceModule'] = module;\n\t\tparams['sourcefield'] = sourceField;\n\t\tparams['targetfield'] = targetField;\n\t\tAppConnector.request(params).done(function (data) {\n\t\t\taDeferred.resolve(data);\n\t\t}).fail(function (error, err) {\n\t\t\t\taDeferred.reject(error, err);\n\t\t\t}\n\t\t);\n\t\treturn aDeferred.promise();\n\t},\n\t/**\n\t * Function used to show cancel link in add view and register click event for cancel\n\t */\n\tregisterCancelAddView: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar cancelDiv = form.find('.cancelAddView');\n\t\tcancelDiv.removeClass('d-none');\n\t\tcancelDiv.find('.cancelLink').on('click', function () {\n\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t})\n\t},\n\t/**\n\t * Register all the events related to addView of picklist dependency\n\t */\n\tregisterAddViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tthisInstance.registerCancelAddView(form);\n\t\tthisInstance.getModuleDependencyGraph(form);\n\t\tthisInstance.registerPicklistFieldsChangeEvent(form);\n\t\tthisInstance.registerSubmitEvent();\n\t},\n\t/**\n\t * Register all the events in editView of picklist dependency\n\t */\n\tregisterDependencyGraphEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tform.find('.cancelAddView').addClass('d-none');\n\t\tthisInstance.registerTargetFieldsClickEvent(dependencyGraph);\n\t\tthisInstance.registerTargetFieldsUnmarkAll(dependencyGraph);\n\t\tthisInstance.registerSelectSourceValuesClick(dependencyGraph);\n\t\tthisInstance.registerCancelDependency(form);\n\t},\n\t/**\n\t * Register all the events related to listView of picklist dependency\n\t */\n\tregisterListViewEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar forModule = jQuery('.contentsDiv').find('.pickListSupportedModules').val();\n\t\tthisInstance.listViewForModule = forModule;\n\t\t//thisInstance.triggerDisplayTypeEvent();\n\t\tthisInstance.registerSourceModuleChangeEvent();\n\t},\n\t/**\n\t * Register the click event for cancel picklist dependency changes\n\t */\n\tregisterCancelDependency: function (form) {\n\t\tvar thisInstance = this;\n\t\t//Register click event for cancel link\n\t\tvar cancelDependencyLink = form.find('.cancelDependency');\n\t\tcancelDependencyLink.on('click', function () {\n\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t})\n\t},\n\t/**\n\t * Register the click event for target fields in dependency graph\n\t */\n\tregisterTargetFieldsClickEvent: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.updatedSourceValues = [];\n\t\tdependencyGraph.find('td.picklistValueMapping').on('click', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t}\n\t\t\tif (currentTarget.hasClass('selectedCell')) {\n\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t} else {\n\t\t\t\tcurrentTarget.addClass('selectedCell').removeClass('unselectedCell');\n\t\t\t}\n\t\t});\n\t},\n\tregisterTargetFieldsUnmarkAll: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.updatedSourceValues = [];\n\t\tdependencyGraph.find('.unmarkAll').on('click', function (e) {\n\t\t\tdependencyGraph.find('td.picklistValueMapping').each(function (index) {\n\t\t\t\tvar currentTarget = jQuery(this);\n\t\t\t\tvar sourceValue = currentTarget.data('sourceValue');\n\t\t\t\tif (jQuery.inArray(sourceValue, thisInstance.updatedSourceValues) == -1) {\n\t\t\t\t\tthisInstance.updatedSourceValues.push(sourceValue);\n\t\t\t\t}\n\t\t\t\tcurrentTarget.addClass('unselectedCell').removeClass('selectedCell');\n\t\t\t});\n\t\t});\n\t},\n\t/**\n\t * Function used to update the value mapping to save the picklist dependency\n\t */\n\tupdateValueMapping: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tthisInstance.valueMapping = [];\n\t\tvar sourceValuesArray = thisInstance.updatedSourceValues;\n\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\tfor (var key in sourceValuesArray) {\n\t\t\tlet encodedSourceValue;\n\t\t\tif (typeof sourceValuesArray[key] == 'string') {\n\t\t\t\tencodedSourceValue = sourceValuesArray[key].replace(/\"/g, '\\\\\"');\n\t\t\t} else {\n\t\t\t\tencodedSourceValue = sourceValuesArray[key];\n\t\t\t}\n\t\t\tvar selectedTargetValues = dependencyTable.find('td[data-source-value=\"' + encodedSourceValue + '\"]').filter('.selectedCell');\n\t\t\tvar targetValues = [];\n\t\t\tif (selectedTargetValues.length > 0) {\n\t\t\t\tjQuery.each(selectedTargetValues, function (index, element) {\n\t\t\t\t\ttargetValues.push(jQuery(element).data('targetValue'));\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\ttargetValues.push('');\n\t\t\t}\n\t\t\tthisInstance.valueMapping.push({'sourcevalue': sourceValuesArray[key], 'targetvalues': targetValues});\n\t\t}\n\t},\n\t/**\n\t * register click event for select source values button in add/edit view\n\t */\n\tregisterSelectSourceValuesClick: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tdependencyGraph.find('button.sourceValues').on('click', function () {\n\t\t\tvar selectSourceValues = dependencyGraph.find('.modalCloneCopy');\n\t\t\tvar clonedContainer = selectSourceValues.clone(true, true).removeClass('modalCloneCopy');\n\t\t\tvar callBackFunction = function (data) {\n\t\t\t\tdata.find('.sourcePicklistValuesModal').removeClass('d-none');\n\t\t\t\tdata.find('[name=\"saveButton\"]').on('click', function (e) {\n\t\t\t\t\tthisInstance.selectedSourceValues = [];\n\t\t\t\t\tvar sourceValues = data.find('.sourceValue');\n\t\t\t\t\tjQuery.each(sourceValues, function (index, ele) {\n\t\t\t\t\t\tvar element = jQuery(ele);\n\t\t\t\t\t\tvar value = element.val();\n\t\t\t\t\t\tvar encodedValue;\n\t\t\t\t\t\tif (typeof value == 'string') {\n\t\t\t\t\t\t\tencodedValue = value.replace(/\"/g, '\\\\\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tencodedValue = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar hiddenElement = selectSourceValues.find('[type=\"checkbox\"].sourceValue.' + encodedValue);\n\t\t\t\t\t\tif (element.is(':checked')) {\n\t\t\t\t\t\t\tthisInstance.selectedSourceValues.push(value);\n\t\t\t\t\t\t\thiddenElement.prop('checked', true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thiddenElement.prop('checked', false);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t\tthisInstance.loadMappingForSelectedValues(dependencyGraph);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tapp.showModalWindow(clonedContainer, function (data) {\n\t\t\t\tif (typeof callBackFunction == 'function') {\n\t\t\t\t\tcallBackFunction(data);\n\t\t\t\t}\n\t\t\t}, {'width': '1000px'});\n\t\t});\n\t},\n\t/**\n\t * Function used to load mapping for selected picklist fields\n\t */\n\tloadMappingForSelectedValues: function (dependencyGraph) {\n\t\tvar thisInstance = this;\n\t\tvar allSourcePickListValues = JSON.parse(dependencyGraph.find('.allSourceValues').val());\n\t\tvar dependencyTable = dependencyGraph.find('.pickListDependencyTable');\n\t\tfor (var key in allSourcePickListValues) {\n\t\t\tif (typeof allSourcePickListValues[key] == 'string') {\n\t\t\t\tvar encodedSourcePickListValue = allSourcePickListValues[key].replace(/\"/g, '\\\\\"');\n\t\t\t} else {\n\t\t\t\tencodedSourcePickListValue = allSourcePickListValues[key];\n\t\t\t}\n\t\t\tvar mappingCells = dependencyTable.find('[data-source-value=\"' + encodedSourcePickListValue + '\"]');\n\t\t\tif (jQuery.inArray(allSourcePickListValues[key], thisInstance.selectedSourceValues) == -1) {\n\t\t\t\tmappingCells.hide();\n\t\t\t} else {\n\t\t\t\tmappingCells.show();\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * This function will save the picklist dependency details\n\t */\n\tsavePickListDependency: function (form) {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar data = form.serializeFormData();\n\t\tdata['module'] = app.getModuleName();\n\t\tdata['parent'] = app.getParentModuleName();\n\t\tdata['action'] = 'SaveAjax';\n\t\tdata['mapping'] = JSON.stringify(thisInstance.valueMapping);\n\t\tAppConnector.request(data).done(function (data) {\n\t\t\tif (data['success']) {\n\t\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t\tvar params = {};\n\t\t\t\tparams.text = app.vtranslate('JS_PICKLIST_DEPENDENCY_SAVED');\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t\tthisInstance.loadListViewContents(thisInstance.listViewForModule);\n\t\t\t}\n\t\t}).fail(function (error) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * This function will load the listView contents after Add/Edit picklist dependency\n\t */\n\tloadListViewContents: function (forModule) {\n\t\tvar thisInstance = this;\n\t\tvar progressIndicatorElement = jQuery.progressIndicator({\n\t\t\t'position': 'html',\n\t\t\t'blockInfo': {\n\t\t\t\t'enabled': true\n\t\t\t}\n\t\t});\n\t\tvar params = {};\n\t\tparams['module'] = app.getModuleName();\n\t\tparams['parent'] = app.getParentModuleName();\n\t\tparams['view'] = 'List';\n\t\tparams['formodule'] = forModule;\n\n\t\tAppConnector.requestPjax(params).done(function (data) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t\t//replace the new list view contents\n\t\t\tjQuery('.contentsDiv').html(data);\n\t\t\tApp.Fields.Picklist.changeSelectElementView(jQuery('.contentsDiv').find('.pickListSupportedModules'));\n\t\t\tthisInstance.registerListViewEvents();\n\t\t}).fail(function (error, err) {\n\t\t\tprogressIndicatorElement.progressIndicator({'mode': 'hide'});\n\t\t});\n\t},\n\t/**\n\t * trigger the display type event to show the width\n\t */\n\ttriggerDisplayTypeEvent: function () {\n\t\tvar widthType = app.cacheGet('widthType', 'narrowWidthType');\n\t\tif (widthType) {\n\t\t\tvar elements = jQuery('.listViewEntriesTable').find('td,th');\n\t\t\telements.attr('class', widthType);\n\t\t}\n\t},\n\t/**\n\t * register change event for source module in add/edit picklist dependency\n\t */\n\tregisterSourceModuleChangeEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar container = jQuery('.contentsDiv');\n\t\tcontainer.find('.pickListSupportedModules').on('change', function (e) {\n\t\t\tvar currentTarget = jQuery(e.currentTarget);\n\t\t\tvar forModule = currentTarget.val();\n\t\t\tthisInstance.loadListViewContents(forModule);\n\t\t});\n\t},\n\t/**\n\t * register the form submit event\n\t */\n\tregisterSubmitEvent: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tvar dependencyGraph = jQuery('#dependencyGraph');\n\t\tform.on('submit', function (e) {\n\t\t\te.preventDefault();\n\t\t\ttry {\n\t\t\t\tthisInstance.updateValueMapping(dependencyGraph);\n\t\t\t} catch (e) {\n\t\t\t\tbootbox.alert(e.message);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (form.find('.editDependency').val() != \"true\" && thisInstance.valueMapping.length < 1) {\n\t\t\t\tvar params = {};\n\t\t\t\tparams.text = app.vtranslate('JS_PICKLIST_DEPENDENCY_NO_SAVED');\n\t\t\t\tparams.type = 'info';\n\t\t\t\tSettings_Vtiger_Index_Js.showMessage(params);\n\t\t\t} else {\n\t\t\t\tthisInstance.savePickListDependency(form);\n\t\t\t}\n\n\t\t});\n\t},\n\t/**\n\t * register events for picklist dependency\n\t */\n\tregisterEvents: function () {\n\t\tvar thisInstance = this;\n\t\tvar form = jQuery('#pickListDependencyForm');\n\t\tif (form.length > 0) {\n\t\t\tvar element = form.find('.dependencyMapping');\n\t\t\tif (form.find('.editDependency').val() == \"true\") {\n\t\t\t\tform.find('select[name=\"sourceModule\"],select[name=\"sourceField\"],select[name=\"targetField\"]').prop(\"disabled\", true);\n\t\t\t\tthisInstance.registerDependencyGraphEvents();\n\t\t\t\tthisInstance.registerSubmitEvent();\n\t\t\t} else {\n\t\t\t\tthisInstance.registerAddViewEvents();\n\t\t\t}\n\t\t} else {\n\t\t\tthisInstance.registerListViewEvents();\n\t\t}\n\t}\n\n});\n\njQuery(document).ready(function () {\n\tvar instance = new Settings_PickListDependency_Js();\n\tinstance.registerEvents();\n})\n"],"names":["jQuery","Class","pickListDependencyInstance","triggerAdd","event","stopPropagation","Settings_PickListDependency_Js","instance","updatedSourceValues","showEditView","listViewForModule","done","registerAddViewEvents","triggerEdit","module","sourceField","targetField","form","find","prop","registerDependencyGraphEvents","registerSubmitEvent","triggerDelete","currentTarget","currentTrEle","closest","message","app","vtranslate","Vtiger_Helper_Js","showConfirmationBox","deleteDependency","params","text","Settings_Vtiger_Index_Js","showMessage","fadeOut","remove","init","valueMapping","selectedSourceValues","Deferred","progressIndicatorElement","progressIndicator","getModuleName","getParentModuleName","AppConnector","requestPjax","data","container","html","App","Fields","Picklist","showSelect2ElementView","dropdownCss","aDeferred","resolve","fail","error","reject","promise","getModuleDependencyGraph","on","val","thisInstance","forModule","registerPicklistFieldsChangeEvent","checkValuesForDependencyGraph","select2SourceField","getSelect2ElementFromSelect","select2TargetField","sourceFieldValue","targetFieldValue","dependencyGraph","addClass","validationEngine","resultMessage","checkCyclicDependency","sourceModule","result","removeClass","addNewDependencyPickList","request","$","mode","parent","view","sourcefield","targetfield","css","err","registerCancelAddView","cancelDiv","loadListViewContents","registerTargetFieldsClickEvent","registerTargetFieldsUnmarkAll","registerSelectSourceValuesClick","registerCancelDependency","registerListViewEvents","registerSourceModuleChangeEvent","cancelDependencyLink","e","sourceValue","inArray","push","hasClass","each","updateValueMapping","dependencyTable","encodedSourceValue","key","sourceValuesArray","replace","filter","targetValues","length","selectedTargetValues","index","element","clonedContainer","selectSourceValues","clone","callBackFunction","sourceValues","ele","value","encodedValue","is","hiddenElement","hideModalWindow","loadMappingForSelectedValues","showModalWindow","allSourcePickListValues","JSON","parse","encodedSourcePickListValue","mappingCells","hide","show","savePickListDependency","serializeFormData","stringify","changeSelectElementView","triggerDisplayTypeEvent","cacheGet","widthType","elements","attr","preventDefault","alert","type","registerEvents","document","ready"],"mappings":"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"}