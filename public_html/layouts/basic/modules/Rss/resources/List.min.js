'use strict';

Vtiger_List_Js('Rss_List_Js',{},{getDocumentHeight:function a(){return jQuery(document).height()},registerRssButtonClickEvent:function c(a){var b=this;a.on('click','.rssAddButton',function(){b.showRssModal('getRssAddForm').done(function(a){app.showModalWindow(a,function e(a){var c=app.validationEngineOptions,d=a.find('#rssAddForm');c.onValidationComplete=function(a,c){return c&&b.rssFeedSave(a),!1},d.validationEngine(c);});});}),a.on('click','.changeFeedSource',function(){b.showRssModal('getRssWidget').done(function(a){app.showModalWindow(a,function c(a){a.on('click','.rssLink',function(a){var c=jQuery(a.currentTarget),d=c.data('id');b.getRssFeeds(d).done(function(){app.hideModalWindow();});});});});});},breadCrumbsFilter:function a(){},showRssModal:function f(a){var c=jQuery.Deferred(),d=jQuery.progressIndicator({}),e={module:app.getModuleName(),view:'ViewTypes',mode:a};return AppConnector.request(e).done(function(a){d.progressIndicator({mode:'hide'}),c.resolve(a);},function(){}),c.promise()},rssFeedSave:function f(a){var b=this,c=a.serializeFormData(),d=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),e={module:app.getModuleName(),action:'Save',feedurl:c.feedurl};AppConnector.request(e).done(function(a){if(d.progressIndicator({mode:'hide'}),a.result.success)app.hideModalWindow(),b.getRssFeeds(a.result.id);else{var c={title:app.vtranslate('JS_MESSAGE'),text:app.vtranslate(a.result.message)};Vtiger_Helper_Js.showPnotify(c);}});},getRssFeeds:function g(a){var b=this,c=jQuery.Deferred(),d=b.getListViewContainer(),e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),f={module:app.getModuleName(),view:'List',id:a};return AppConnector.requestPjax(f).done(function(a){c.resolve(a),d.find('#listViewContents').html(a),b.setFeedContainerHeight(d),e.progressIndicator({mode:'hide'});}),c.promise()},setFeedContainerHeight:function c(a){var b=this.getDocumentHeight()/1.5;a.find('.feedListContainer').height(b);},registerFeedClickEvent:function c(a){var b=this;a.on('click','.feedLink',function(c){var d=jQuery(c.currentTarget),e=d.data('url'),f=b.getFrameElement(e);a.find('.feedFrame').html(f);});},getFrameElement:function d(a){var b=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}}),c=jQuery('<iframe>',{id:'feedFrame',scrolling:'auto',width:'100%',height:this.getDocumentHeight()/2});return c.addClass('table-bordered'),this.getHtml(a).done(function(a){b.progressIndicator({mode:'hide'});var d=c[0].contentDocument;d.open(),d.write(a),d.close();}),c},getHtml:function d(a){var b=jQuery.Deferred(),c={module:app.getModuleName(),action:'GetHtml',url:a};return AppConnector.request(c).done(function(a){b.resolve(a.result.html);}),b.promise()},registerDeleteRecordClickEvent:function c(){var a=this.getListViewContainer(),b=this;a.on('click','#deleteButton',function(){b.deleteRecord(a);});},deleteRecord:function e(a){var b=this,c=a.find('#recordId').val(),d=app.vtranslate('LBL_DELETE_CONFIRMATION');Vtiger_Helper_Js.showConfirmationBox({message:d}).done(function(){var a=app.getModuleName(),d=app.vtranslate('JS_RECORD_GETTING_DELETED'),e=jQuery.progressIndicator({message:d,position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:a,action:'DeleteAjax',record:c}).done(function(a){if(e.progressIndicator({mode:'hide'}),a.success)b.getRssFeeds();else{var c={text:app.vtranslate(a.error.message),title:app.vtranslate('JS_LBL_PERMISSION')};Vtiger_Helper_Js.showPnotify(c);}},function(){});},function(){});},registerMakeDefaultClickEvent:function c(a){var b=this;a.on('click','#makeDefaultButton',function(){b.makeDefault(a);});},makeDefault:function f(a){var b=Vtiger_List_Js.getInstance(),c=a.find('#recordId').val(),d=app.getModuleName(),e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request({module:d,action:'MakeDefaultAjax',record:c}).done(function(a){if(e.progressIndicator({mode:'hide'}),a.success){var b={title:app.vtranslate('JS_MESSAGE'),text:app.vtranslate(a.result.message),type:'info'};Vtiger_Helper_Js.showPnotify(b);}else Vtiger_Helper_Js.showPnotify({text:app.vtranslate(a.error.message),title:app.vtranslate('JS_LBL_PERMISSION')});});},registerEvents:function b(){this._super();var a=this.getListViewContainer();this.registerRssButtonClickEvent(a),this.registerFeedClickEvent(a),this.registerMakeDefaultClickEvent(a),this.setFeedContainerHeight(a),this.registerDeleteRecordClickEvent();}});
//# sourceMappingURL=List.min.js.map
