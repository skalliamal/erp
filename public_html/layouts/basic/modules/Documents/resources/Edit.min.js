'use strict';

Vtiger_Edit_Js('Documents_Edit_Js',{},{INTERNAL_FILE_LOCATION_TYPE:'I',EXTERNAL_FILE_LOCATION_TYPE:'E',getMaxiumFileUploadingSize:function b(a){return a.find('.maxUploadSize').data('value')},isFileLocationInternalType:function b(a){return !(a.val()!=this.INTERNAL_FILE_LOCATION_TYPE)},isFileLocationExternalType:function b(a){return !(a.val()!=this.EXTERNAL_FILE_LOCATION_TYPE)},convertFileSizeInToDisplayFormat:function c(a){var b=-1;do a/=1024,b++;while(1024<a);return Math.max(a,.1).toFixed(1)+[' kB',' MB',' GB',' TB','PB','EB','ZB','YB'][b]},registerFileLocationTypeChangeEvent:function c(a){var b=this;a.on('change','select[name="filelocationtype"]',function(){var c,d=a.find('[name="filelocationtype"]'),e=a.find('[name="filename"]');c=b.isFileLocationInternalType(d)?jQuery('<input type="file"/>'):jQuery('<input type="text" />');for(var f,g=e.get(0).attributes,h=0;h<g.length;h++)if(f=g[h],'type'!=f.name&&'value'!=f.name&&'class'!=f.name){var i=f.value,j='';'data-fieldinfo'==f.name&&(i=JSON.parse(i),b.isFileLocationExternalType(d)?(i.type='url',j='form-control'):i.type='file',i=JSON.stringify(i)),c.attr(f.name,i),c.addClass(j);}e.replaceWith(c);var k=c.closest('.fieldValue'),l=k.find('.uploadedFileDetails');b.isFileLocationExternalType(d)?l.addClass('d-none').removeClass('show'):l.addClass('show').removeClass('d-none');});},registerFileChangeEvent:function c(a){var b=this;a.on('change','input[name="filename"]',function(c){if('text'==c.target.type)return !1;file=c.target.files[0];var d=a.find('[name="filename"]');if('file'==d.attr('type')){var e=d.closest('.fileUploadContainer').find('.uploadedFileSize'),f=d.get(0).files[0].size,g=b.getMaxiumFileUploadingSize(a);f>g?(alert(app.vtranslate('JS_EXCEEDS_MAX_UPLOAD_SIZE')),d.val(''),e.text('')):e.text(b.convertFileSizeInToDisplayFormat(f));}});},quickCreateSave:function f(a){var b=this,c=jQuery.Deferred(),d=new FormData(a[0]),e=a.find('[name="filelocationtype"]');if('undefined'!=typeof file&&b.isFileLocationInternalType(e)&&(d.append('filename',file),file=!1),d){AppConnector.request({url:'index.php',type:'POST',data:d,processData:!1,contentType:!1}).done(function(a){c.resolve(a);}).fail(function(a,b){c.reject(a,b);});}return c.promise()},registerBasicEvents:function b(a){this._super(a),this.registerFileLocationTypeChangeEvent(a),this.registerFileChangeEvent(a);},registerEvents:function a(){this._super();}});
//# sourceMappingURL=Edit.min.js.map
