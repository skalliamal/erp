'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

jQuery.Class("YetiForce_ListSearch_Js",{getInstance:function g(a,b,c,d){"undefined"==typeof d&&(d=app.getModuleName());var e=module+"_ListSearch_Js";if("undefined"!=typeof window[e])var f=new window[e](a,b,c);else var f=new window.YetiForce_ListSearch_Js(a,b,c);return f.moduleName=d,f}},{moduleName:!1,container:!1,reletedInstance:!1,viewName:!1,init:function d(a,b,c){"undefined"==typeof a&&(a=jQuery(".bodyContents")),this.setContainer(a),!0!=b&&this.getContainer().find("[data-trigger=\"listSearch\"]").length&&this.initialize(),this.reletedInstance=c;},setContainer:function b(a){this.container=a;},getContainer:function a(){return this.container},setViewName:function b(a){this.viewName=a;},initialize:function a(){this.registerEvents();},getAlphabetSearchField:function a(){return jQuery("#alphabetSearchKey").val()},getAlphabetSearchValue:function a(){return jQuery("#alphabetValue").val()},registerListSearch:function c(){var a=this,b=this.getContainer();b.find("[data-trigger=\"listSearch\"]").on("click",function(){a.reloadList();}),b.find("input.listSearchContributor").on("keypress",function(b){13==b.keyCode&&a.triggerListSearch();}),b.find(".removeSearchConditions").on("click",function(){a.reloadList({search_params:[],search_key:"",search_value:"",operator:""});});},registerListViewSelect:function c(){var a=this,b=this.getContainer();b.find(".listViewEntriesTable .select2noactive").each(function(a,b){var c=$(b);c.data("select2")||App.Fields.Picklist.showSelect2ElementView(c,{placeholder:app.vtranslate("JS_SELECT_AN_OPTION")});}),"1"==app.getMainParams("autoRefreshListOnChange")&&(b.find(".listViewEntriesTable select").on("change",function(){a.triggerListSearch();}),b.find(".listViewEntriesTable .picklistSearchField").on("apply.daterangepicker",function(){a.triggerListSearch();}),b.find(".listViewEntriesTable .dateField").on("DatePicker.onHide",function(){var b=$(this).data("prevVal"),c=$(this).val();b!=c&&a.triggerListSearch();}),b.find(".clockPicker").on("change",function(){a.triggerListSearch();}));},resetPagination:function a(){jQuery("#deSelectAllMsg").trigger("click"),jQuery("#recordsCount").val(""),jQuery("#pageNumber").val("1"),jQuery("#pageToJump").val("1"),jQuery("#totalPageCount").text(""),jQuery(".pagination").data("totalCount",0);},triggerListSearch:function c(){var a=this,b=a.getContainer();b.find("[data-trigger=\"listSearch\"]").trigger("click");},registerDateListSearch:function a(){App.Fields.Date.registerRange(this.getContainer().find(".dateRangeField"));},registerTimeListSearch:function a(){app.registerEventForClockPicker();},registerAlphabetClick:function b(){var a=this;this.getContainer().find(".alphabetBtn").on("click",function(){app.showModalWindow($(".alphabetModal").html(),function(b){a.registerEventForAlphabetSearch(b);});});},getCurrentCvId:function a(){return jQuery("#customFilter").find("option:selected").data("id")},registerEventForAlphabetSearch:function c(a){var b=this;a.find(".alphabetSearch").on("click",function(a){var c=jQuery(a.currentTarget).find("a").text(),d=b.getCurrentCvId(),e=b.getAlphabetSearchField();b.resetPagination(),b.reloadList({viewname:d,search_key:e,search_value:c,operator:"s",page:1}),app.hideModalWindow();}),a.find(".removeAlfabetCondition").on("click",function(){b.reloadList({search_key:"",search_value:"",operator:""}),app.hideModalWindow();});},updatePaginationOnAlphabetChange:function e(a,b){var c=this,d={};d.module=c.moduleName,d.parent=app.getParentModuleName(),d.view="Pagination",d.page=1,d.mode="getPagination",d.search_key=b,d.search_value=a,d.operator="s",AppConnector.request(d).done(function(a){jQuery(".paginationDiv").html(a);var b=c.getInstanceView();b&&b!=null&&jQuery.isFunction(b.registerPageNavigationEvents)&&b.registerPageNavigationEvents();});},getListSearchParams:function h(a){var b=this.getContainer(),c=b.find(".listViewEntriesTable"),d=[];if(c.find(".listSearchContributor").each(function(a,b){var c=[],e=jQuery(b),f=e.data("fieldinfo"),g=e.attr("name"),h=e.val();if("object"==("undefined"==typeof h?"undefined":_typeof(h))&&(null==h?h="":h=h.join("##")),h=h.trim(),0>=h.length)return !0;var i="a";if(f.hasOwnProperty("searchOperator")?i=f.searchOperator:0<=jQuery.inArray(f.type,["modules","time","userCreator","owner","picklist","tree","boolean","fileLocationType","userRole","companySelect","multiReferenceValue"])?i="e":"date"==f.type||"datetime"==f.type?i="bw":("multipicklist"==f.type||"categoryMultipicklist"==f.type)&&(i="c"),c.push(g),c.push(i),c.push(h),"tree"==f.type||"categoryMultipicklist"==f.type){var j=jQuery(".listViewHeaders .searchInSubcategories[data-columnname=\""+g+"\"]").prop("checked");c.push(j);}d.push(c);}),a){var e=null,f=app.getUrlVar("search_params");if(null!=f&&f.length){var g=f.length;"#"===f.charAt(g-1)&&(f=f.substr(0,g-1)),f=JSON.parse(decodeURIComponent(f)),$.each(f[0],function(a,b){var f=!1;$.each(d,function(a,c){c[0]==b[0]&&(f=!0);}),e=c.find(".listSearchContributor[name=\""+b[0]+"\"]").val(),!1==f&&""!=e&&null!==e&&d.push(b);});}}return [d]},getInstanceByView:function c(){var a=this.viewName?this.viewName:app.getViewName(),b=!1;return "RecordsList"===a?(b=this.reletedInstance,b.reloadFunctionName="loadRecordList",b.execute=["updatePagination"]):this.reletedInstance?(b=this.reletedInstance,b.reloadFunctionName="loadRelatedList"):"Detail"===a?(b=Vtiger_Detail_Js.getInstance(),b.reloadFunctionName="loadRelatedList"):"List"==a?(b=new Vtiger_List_Js,b.reloadFunctionName="getListViewRecords",b.execute=["updatePagination"]):"ListPreview"==a&&(b=window.pageController,b.reloadFunctionName="getListViewRecords",b.execute=["updatePagination"]),b},reloadList:function e(a){var b=this;a==null&&(a={page:1});var c=this.getInstanceByView();if(c){var d=c.reloadFunctionName;jQuery.isFunction(c[d])&&c[d](a).done(function(){b.resetPagination(),b.executeFunctions(c);});}},executeFunctions:function e(a){if(a.execute){var b=a.execute;for(var c in b){var d=b[c];jQuery.isFunction(a[d])&&a[d]();}}},registerBasicEvents:function a(){this.registerListViewSelect(),this.registerDateListSearch(),this.registerTimeListSearch(),this.registerAlphabetClick(),this.registerListSearch(),this.getContainer().find("select.select2").each(function(a,b){$(b).data("select2")||App.Fields.Picklist.showSelect2ElementView($(b));});},registerEvents:function a(){this.registerBasicEvents();}});
//# sourceMappingURL=ListSearch.min.js.map
