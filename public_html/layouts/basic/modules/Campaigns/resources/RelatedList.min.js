'use strict';

Vtiger_RelatedList_Js('Campaigns_RelatedList_Js',{triggerSendEmail:function a(){Vtiger_List_Js.triggerSendEmail({relatedLoad:!0,sourceModule:app.getModuleName(),sourceRecord:app.getRecordId(),module:jQuery('.relatedModuleName').val(),cvid:jQuery('#recordsFilter').val()});}},{getCompleteParams:function c(){var a=this._super(),b=this.getRelatedContainer();return a.selectedIds=b.find('#selectedIds').data('selectedIds'),a.excludedIds=b.find('#excludedIds').data('excludedIds'),a},changeCustomFilterElementView:function c(){var a=this.content.find('#recordsFilter');if(0<a.length){App.Fields.Picklist.showSelect2ElementView(a,{templateSelection:function c(a){var b=jQuery('<span></span>');return b.append(jQuery(jQuery('.filterImage').detach().get(0)).show()),b.append(a.text),b},customSortOptGroup:!0,closeOnSelect:!0});var b=a.data('select2');b.$dropdown.append(this.content.find('span.filterActionsDiv'));}},registerChangeCustomFilterEvent:function e(){var a=this,b=a.getRelatedContainer(),c=b.find('.loadFormFilterButton'),d=b.find('#recordsFilter');c.on('click',function(){var a=app.vtranslate('JS_LBL_ARE_YOU_SURE_YOU_WANT_TO_ADD_THIS_FILTER');Vtiger_Helper_Js.showConfirmationBox({message:a}).done(function(){var a=d.val(),c=b.find('.relatedModuleName').val(),e={sourceRecord:app.getRecordId(),relatedModule:c,viewId:a,module:app.getModuleName(),action:'RelationAjax',mode:'addRelationsFromRelatedModuleViewId'},f=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request(e).done(function(a){if(f.progressIndicator({mode:'hide'}),!1===a.result){var b=app.vtranslate('JS_NO_RECORDS_RELATED_TO_THIS_FILTER');Vtiger_Helper_Js.showMessage({text:b,type:'info'});}else Vtiger_Detail_Js.reloadRelatedList();}).fail(function(){f.progressIndicator({mode:'hide'});});});});},registerEventToEditRelatedStatus:function d(){var a=this,b=a.getRelatedContainer();b.find('.currentStatus').on('click',function(a){a.stopImmediatePropagation();var b=jQuery(a.currentTarget);b.addClass('open');});var c=b.find('.currentStatus').find('.dropdown-menu');c.on('click','a',function(b){b.stopImmediatePropagation();var c=jQuery(b.currentTarget),d=c.closest('li'),e=c.closest('.currentStatus'),f=d.attr('id'),g=d.data('status'),h=c.closest('tr').data('id'),i={relatedModule:a.relatedModulename,relatedRecord:h,status:f,module:app.getModuleName(),action:'RelationAjax',sourceRecord:a.parentRecordId,mode:'updateStatus'};c.progressIndicator(),AppConnector.request(i).done(function(a){a.result[0]&&(c.progressIndicator({mode:'hide'}),e.find('.statusValue').text(g),e.removeClass('open'));}).fail(function(){c.progressIndicator({mode:'hide'});});});},registerPostLoadEvents:function a(){this._super(),this.changeCustomFilterElementView(),this.registerChangeCustomFilterEvent(),this.registerEventToEditRelatedStatus();}});
//# sourceMappingURL=RelatedList.min.js.map
