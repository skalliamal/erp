'use strict';

Vtiger_Detail_Js('Accounts_Detail_Js',{},{accountHierarchyResponseCache:{},getAccountHierarchyResponseData:function d(a){var b=this,c=jQuery.Deferred();return jQuery.isEmptyObject(b.accountHierarchyResponseCache)?AppConnector.request(a).done(function(a){b.accountHierarchyResponseCache=a,c.resolve(b.accountHierarchyResponseCache);}):c.resolve(b.accountHierarchyResponseCache),c.promise()},registerButtons:function b(a){a.find('.toChangeBtn').on('click',function(a){var b=$(a.currentTarget),c=b.data('fieldname'),d={value:b.hasClass('btn-success')?0:1,field:c,record:b.data('recordId'),module:app.getModuleName(),action:'SaveAjax'};AppConnector.request(d).done(function(a){b.hasClass('btn-warning')?(b.removeClass('btn-warning'),b.addClass('btn-success')):(b.addClass('btn-warning'),b.removeClass('btn-success')),b.html(a.result[c].display_value);var d={title:app.vtranslate('JS_LBL_PERMISSION'),text:app.vtranslate('JS_SAVE_NOTIFY_OK'),type:'success'};Vtiger_Helper_Js.showMessage(d);});});},displayAccountHierarchyResponseData:function c(a){var b=this;app.showModalWindow(a,function(a){var c=a.find('.maxHeightModal');app.showScrollBar(c,{height:c.height,railVisible:!0,size:'6px'}),b.registerButtons(a);});},registerHierarchyRecordCount:function c(){var a=$('.detailViewTitle .hierarchy');if(a.length){var b={module:app.getModuleName(),action:'RelationAjax',record:app.getRecordId(),mode:'getHierarchyCount'};AppConnector.request(b).done(function(a){a.success&&$('.detailViewTitle .hierarchy .badge').html(a.result);});}},registerShowHierarchy:function d(){var a=this,b=$('.detailViewTitle'),c='index.php?module=Accounts&view=AccountHierarchy&record='+app.getRecordId();b.on('click','.js-detail__icon, .recordLabelValue',function(){a.getAccountHierarchyResponseData(c).done(function(b){a.displayAccountHierarchyResponseData(b);});});},registerEvents:function a(){this._super(),this.registerHierarchyRecordCount(),this.registerShowHierarchy();}});
//# sourceMappingURL=Detail.min.js.map
