'use strict';

jQuery.Class('KnowledgeBase_Tree_Js',{},{treeInstance:!1,content:!1,getContent:function a(){return this.content||(this.content=$('.contentOfData')),this.content},generateTree:function e(a,b){var c=this;c.treeInstance=a.find('#treeContent');var d=b.result;c.treeInstance.jstree({core:{data:d,themes:{name:'proton',responsive:!0}},plugins:['search']});},loadTree:function f(a){var b=this,c=$('.treeContainer'),d={module:app.getModuleName(),action:'DataTreeAjax'},e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});a&&b.treeInstance.jstree('destroy'),AppConnector.request(d).done(function(a){e.progressIndicator({mode:'hide'}),b.generateTree(c,a),b.registerTreeEvents(c);});},searchingInTree:function b(a){this.treeInstance.jstree(!0).search(a);},registerSearchEvent:function d(){var a=this,b=$('#valueSearchTree'),c=$('#btnSearchTree');b.on('keypress',function(c){13==c.which&&a.searchingInTree(b.val());}),c.on('click',function(){a.searchingInTree(b.val());});},loadContent:function f(a){var b=this,c=b.getContent(),d={module:app.getModuleName(),view:'Content'};'undefined'!=typeof a&&(d.record=a);var e=jQuery.progressIndicator({position:'html',blockInfo:{enabled:!0}});AppConnector.request(d).done(function(b){e.progressIndicator({mode:'hide'}),c.html(b),'undefined'==typeof a&&($.extend($.fn.dataTable.defaults,{language:{sLengthMenu:app.vtranslate('JS_S_LENGTH_MENU'),sZeroRecords:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfo:app.vtranslate('JS_S_INFO'),sInfoEmpty:app.vtranslate('JS_S_INFO_EMPTY'),sSearch:app.vtranslate('JS_SEARCH'),sEmptyTable:app.vtranslate('JS_NO_RESULTS_FOUND'),sInfoFiltered:app.vtranslate('JS_S_INFO_FILTERED'),sLoadingRecords:app.vtranslate('JS_LOADING_OF_RECORDS'),sProcessing:app.vtranslate('JS_LOADING_OF_RECORDS'),oPaginate:{sFirst:app.vtranslate('JS_S_FIRST'),sPrevious:app.vtranslate('JS_S_PREVIOUS'),sNext:app.vtranslate('JS_S_NEXT'),sLast:app.vtranslate('JS_S_LAST')},oAria:{sSortAscending:app.vtranslate('JS_S_SORT_ASCENDING'),sSortDescending:app.vtranslate('JS_S_SORT_DESCENDING')}}}),c.find('.dataTableWithDocuments').dataTable());});},registerTreeEvents:function b(){var a=this;a.registerSearchEvent(),a.treeInstance.on('changed.jstree',function(b,c){'folder'!=c.node.original.type&&a.loadContent(c.node.original.record_id);});},registerBasicEvents:function b(){var a=this;$('.addRecord').on('click',function(){var b=Vtiger_Header_Js.getInstance(),c=app.getModuleName();b.quickCreateModule(c,{callbackFunction:function b(){a.loadTree(!0),a.loadContent();},noCache:!1});});},registerEvents:function b(){var a=this;a.registerBasicEvents(),a.loadTree(!1),a.loadContent();}});
//# sourceMappingURL=Tree.min.js.map
